import{d as ee,l as d,m as ae,g as oe,p as te,o as k,e as O,Q as r,x as o,_ as ne,r as i,B as n,i as l,a6 as D,S as x,L as le,a as se,f as N}from"./vue.BCHSKM6y.js";import{_ as re}from"./info-icon.D_5ulZjW.js";import{I as ce,a as de,u as ue,b as ie,c as me,V as fe,e as pe,y as ge,t as y,W as ye,g as _e,X as ve,Y as he}from"./index.Cjri3_sP.js";import{_ as m}from"./BaseInfoItem.vue_vue_type_style_index_0_lang.DMYgpoJW.js";import"./right-arrow-icon.CaFxgYzl.js";const Ie={class:"add-home-box hk-flex hk-flex-col container-setPx"},be={class:"add-home-form"},ke={class:"hk-flex hk-items-center"},xe=l("div",{class:"wktime-info-desc"},"填写的工作时长为每日正常工作时长，超出正常工作时长的部分为加班时长，如填0则不计算加班时长。",-1),Ce=l("img",{class:"wktime-info-icon",src:re,alt:"",srcset:""},null,-1),Ve={class:"hk-flex hk-items-center wktime-info-value"},Te=l("span",null,"小时",-1),Re={class:"form-upload-img-box home-upload-img-box"},He={class:"form-upload-img-tit"},Se={key:0,class:"form-upload-img"},Ae=l("div",{class:"footer-aux-btmbox"},null,-1),Ue={class:"footer-btn-box"},Le=l("div",{class:"short-tips-dialog"},[l("div",{class:"pd-dialog-content"},"所选国家与货币不匹配，请再次确认")],-1),we=l("div",{class:"short-tips-dialog"},[l("div",{class:"pd-dialog-content"},"修改货币种类仅修改名称，不会切换汇率")],-1),qe=ee({__name:"addHome",setup(Pe){const{t:s}=ie(),C=ne(),c=d(C.query.id),V=ce.inApp(),{pageLoading:M,endPageLoading:q}=de({}),_=d(!1),T=d(null),R=d(null),v=d(null),h=d(null),I=d([]),b=d(null),{comeback:F,pushName:Y}=me(),{hkMessage:p}=_e(),H=ue(),$=t=>{let e=t.replace(/[^0-9.,]/g,"");return t.match(/\d+(\.\d{0,1})?/)&&(e=e.match(/\d+(\.\d{0,1})?/)[0]),e=+e>=23?"23":e,e},a=ae({name:"",country:"中国",countryId:1,area:"",address:"",currency:"CNY",currencyId:1,pictrue:"",overTime:0,areaInfo:{}}),S=oe(()=>!!a.name&&!!a.country&&!!a.currency),E=t=>{a.areaInfo=t,a.country=t.countryName,a.countryId=t.countryId,a.currency=t.currency,a.currencyId=t.currencyId},A=()=>{T.value.taggleVisible(!0)};let f=null;const Q=t=>{if(c.value){f=t,h.value.taggleDialog(!0);return}a.currency=t.currency,a.currencyId=t.currencyId},W=()=>{a.currency=f.currency,a.currencyId=f.currencyId,f=null,h.value.taggleDialog(!1)},X=()=>{f=null},U=()=>{R.value.taggleVisible(!0)},j=t=>{fe({homeId:+c.value}).then(e=>{e.code===0?(a.name=e.data.nickname,a.country=e.data.country,a.countryId=e.data.countryId,a.area=e.data.area,a.address=e.data.address,a.currency=e.data.currency,a.currencyId=e.data.currencyId,a.pictrue=e.data.avatar,a.overTime=e.data.overTime||0,I.value=[{url:pe+e.data.avatar,baseUrl:e.data.avatar}],e.data.country,e.data.countryId,e.data.currency,e.data.currencyId):p(e.msg)}).finally(()=>{t&&t()})},z=t=>{const e={nickname:a.name,avatar:t,area:a.area,address:a.address,overTime:a.overTime};c.value&&(e.homeId=c.value),e.countryId=a.countryId,e.currencyId=a.currencyId,(c.value?ve:he)(e).then(async g=>{g.code===0?(await H.setHomeSimpleLs(),H.setUserIdent(),c.value?p("保存成功"):p("添加新家成功"),C.query.homeId?Y("Home"):F()):p(g.msg)}).finally(()=>{_.value=!1})},L=()=>{var e;if(!S.value)return;_.value=!0;const t=(e=b.value)==null?void 0:e.getValues();z(t[0])},G=()=>{a.areaInfo.currencyId&&a.currencyId!==a.areaInfo.currencyId?v.value.taggleDialog(!0):L()},J=()=>{v.value.taggleDialog(!1)};return te(()=>{c.value&&j(q)}),(t,e)=>{const w=i("UploadImg"),g=i("AppUploadImg"),K=i("BtmSingleBtn"),P=i("AreaSelect"),B=i("ConfrimPopAgain"),Z=i("MainContainer");return k(),O(Z,{exitLoading:!!c.value,pageLoading:o(M)},{default:r(()=>[n(ge,{title:c.value?o(s)("base.btn.editHome"):o(s)("base.header.addHome")},null,8,["title"]),l("div",Ie,[l("div",be,[n(m,{label:o(s)("base.homeNameTxt"),isRequire:!0},{default:r(()=>[n(o(y),{modelValue:a.name,"onUpdate:modelValue":e[0]||(e[0]=u=>a.name=u),placeholder:o(s)("base.pleaseInputTxt")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),n(m,{label:o(s)("base.countryTxt"),isHaveRArrow:!0,isRequire:!0,onOnHandle:A},{default:r(()=>[l("div",{class:"adh-select-value",onClick:D(A,["stop"])},x(a.country),1)]),_:1},8,["label"]),n(m,{label:o(s)("base.currency"),isHaveRArrow:!0,isRequire:!0,onOnHandle:U},{default:r(()=>[l("div",{class:"adh-select-value",onClick:D(U,["stop"])},x(a.currency),1)]),_:1},8,["label"]),n(m,{label:o(s)("base.areaTxt")},{default:r(()=>[n(o(y),{modelValue:a.area,"onUpdate:modelValue":e[1]||(e[1]=u=>a.area=u),placeholder:o(s)("base.pleaseInputTxt")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),n(m,{label:o(s)("base.addressTxt")},{default:r(()=>[n(o(y),{modelValue:a.address,"onUpdate:modelValue":e[2]||(e[2]=u=>a.address=u),placeholder:o(s)("base.pleaseInputTxt")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),n(m,{label:o(s)("base.addressTxt")},{label:r(()=>[l("div",ke,[le(" 工作时长 "),n(o(ye),{class:"wktime-info-pop",theme:"dark",placement:"top-start","close-on-click-action":!1,"close-on-click-outside":!1,"close-on-click-overlay":!1},{reference:r(()=>[Ce]),default:r(()=>[xe]),_:1})])]),default:r(()=>[l("div",Ve,[n(o(y),{modelValue:a.overTime,"onUpdate:modelValue":e[3]||(e[3]=u=>a.overTime=u),formatter:$,placeholder:"0"},null,8,["modelValue"]),Te])]),_:1},8,["label"]),l("div",Re,[l("div",He,x(o(s)("base.pictrueTxt")),1),o(V)?N("",!0):(k(),se("div",Se,[n(w,{ref_key:"uploadImgRef",ref:b,iconColor:"#ffffff",fileValues:I.value,maxCount:1},null,8,["fileValues"])])),o(V)?(k(),O(g,{key:1,ref_key:"uploadImgRef",ref:b,value:I.value,iconColor:"#ffffff"},null,8,["value"])):N("",!0)])]),Ae,l("div",Ue,[n(K,{loading:_.value,disable:S.value,handleTxt:o(s)("base.btn.save"),onOnHandle:G},null,8,["loading","disable","handleTxt"])])]),n(P,{ref_key:"areaSelectRef",ref:T,title:o(s)("base.countryTxt"),onOnChange:E},null,8,["title"]),n(P,{ref_key:"coinSelectRef",ref:R,isShowCurrency:!0,title:o(s)("base.currency"),onOnChange:Q},null,8,["title"]),n(B,{ref_key:"confirmPopRef",ref:v,popClass:"short-tips-pop",cancelTxt:"确认保存",confirmTxt:"重新选择",customFooter:!0,onOnCancel:L,onOnConfirm:J},{default:r(()=>[Le]),_:1},512),n(B,{ref_key:"mgvalChangeRef",ref:h,popClass:"short-tips-pop",customFooter:!0,onOnCancel:X,onOnConfirm:W},{default:r(()=>[we]),_:1},512)]),_:1},8,["exitLoading","pageLoading"])}}});export{qe as default};
