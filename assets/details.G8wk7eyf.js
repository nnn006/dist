import{d as X,l as _,m as Z,g as ee,p as te,o,e as b,Q as i,x as d,_ as ae,r as T,B as n,a as c,f,i as l,n as M,S as r,a6 as H}from"./vue.BCHSKM6y.js";import{u as se,a as ne,b as oe,c as ie,R as le,a6 as O,a5 as de,Q as R,y as re,t as ue,F as ce,a4 as me,g as fe,a8 as P}from"./index.Cjri3_sP.js";import{_ as m}from"./BaseInfoItem.vue_vue_type_style_index_0_lang.DMYgpoJW.js";import{u as pe,a as ge}from"./index.DllRNd8O.js";import"./right-arrow-icon.CaFxgYzl.js";const ve=["src"],_e=["src"],Te=["src"],he={class:"updata-staff-box hk-flex hk-flex-col container-setPx"},ye={class:"updata-staff-form"},be={key:1},Ie={key:1},ke=l("div",{class:"footer-aux-btmbox"},null,-1),Ce={key:0,class:"footer-btn-box"},xe={key:1,class:"footer-btn-box"},He=l("div",{class:"staff-edit-dialog"},[l("div",{class:"pd-dialog-content"},"确定删除该条记录")],-1),we=X({__name:"details",setup(Re){const{t:I}=oe(),N=ae(),{id:k}=N.query,C=_(null),S=_(null),$=_(null),B=_(null),A=_([]),p=se(),{comeback:L,goback:Se}=ie(),{hkMessage:u}=fe(),s=_(!1),t=Z({nickname:p.userInfo.nickname,homeName:p.userInfo.homeName,client:"",address:"",applicationId:0,startTime:"",endTime:"",status:0,useCarTime:0,auditIdentifyName:"",clientId:0}),{pageLoading:Y,endPageLoading:q}=ne({}),F=a=>{t.client=a==null?void 0:a[0].text,t.clientId=a==null?void 0:a[0].value},U=ee(()=>!!t.nickname),V=a=>{le({applicationId:k}).then(e=>{e.code===0?(t.client=e.data.client,t.clientId=e.data.clientId,t.address=e.data.address,t.applicationId=e.data.applicationId,t.startTime=e.data.startTime?O(e.data.startTime*1e3).format("YYYY-MM-DD HH:mm"):"",t.endTime=e.data.endTime?O(e.data.endTime*1e3).format("YYYY-MM-DD HH:mm"):"",t.status=e.data.status,t.useCarTime=e.data.useCarTime,t.auditIdentifyName=e.data.auditIdentifyName):u(e.msg)}).catch(e=>{u(e)}).finally(()=>{a&&a()})},h=a=>{a===1?S.value.taggleVisible():$.value.taggleVisible()},E=(a,e)=>{t.startTime=`${a[0]}-${a[1]}-${a[2]} ${e[0]}:${e[1]}`},z=(a,e)=>{t.endTime=`${a[0]}-${a[1]}-${a[2]} ${e[0]}:${e[1]}`},Q=()=>{C.value.taggleDialog(!0)},D=()=>{B.value.taggleVisible(!0)},j=()=>{s.value=!0},G=()=>{const a={homeId:p.userInfo.homeId,client:t.client,applicationId:k,startTime:P(t.startTime),endTime:P(t.endTime),address:t.address};pe(a).then(e=>{e.code===0?(u("修改成功"),V(),s.value=!1):u(e.msg)}).catch(e=>{u(e)})},J=a=>{ge({applicationId:k,homeId:p.userInfo.homeId}).then(e=>{e.code===0?(L(),u("删除成功"),C.value.taggleDialog(!1)):u(e.msg)}).catch(e=>{u(e)})},K=()=>new Promise((a,e)=>{de({homeId:p.userInfo.homeId}).then(y=>{if(y.code===0){const x=y.data.list.filter(g=>g.identifyId!==p.userInfo.identifyId).map(g=>({text:g.nickname,value:g.identifyId}));A.value=x,a(!0)}else e()})});return te(async()=>{K(),V(q)}),(a,e)=>{const y=T("BaseHandleBtn"),x=T("BtmSingleBtn"),g=T("ConfrimPopAgain"),w=T("TimeSelect"),W=T("MainContainer");return o(),b(W,{exitLoading:!0,pageLoading:d(Y)},{default:i(()=>[n(re,{title:s.value?"修改出车":"出车详情"},{rightContent:i(()=>[t.status===1?(o(),c("img",{key:0,class:"imprest-header-staimg",src:d(R)("wait"),alt:""},null,8,ve)):f("",!0),t.status===2?(o(),c("img",{key:1,class:"imprest-header-staimg",src:d(R)("pass"),alt:""},null,8,_e)):f("",!0),t.status===6?(o(),c("img",{key:2,class:"imprest-header-staimg",src:d(R)("zuofei"),alt:""},null,8,Te)):f("",!0)]),_:1},8,["title"]),l("div",he,[l("div",ye,[n(m,{label:d(I)("base.nameTxt")},{default:i(()=>[l("div",{class:M({"info-no-input":s.value})},r(t.nickname),3)]),_:1},8,["label"]),n(m,{label:"目的地"},{default:i(()=>[s.value?(o(),b(d(ue),{key:0,modelValue:t.address,"onUpdate:modelValue":e[0]||(e[0]=v=>t.address=v),placeholder:d(I)("base.pleaseInputTxt")},null,8,["modelValue","placeholder"])):(o(),c("div",be,r(t.address),1))]),_:1}),t.status&&t.status!==1?(o(),b(m,{key:0,label:"出车时长"},{default:i(()=>[l("div",null,r(d(ce)(t.useCarTime)),1)]),_:1})):f("",!0),n(m,{label:d(I)("base.belongHomeTxt")},{default:i(()=>[l("div",{class:M({"info-no-input":s.value})},r(t.homeName),3)]),_:1},8,["label"]),n(m,{label:"委派人",isHaveRArrow:s.value,onOnHandle:e[1]||(e[1]=v=>s.value?D():()=>{})},{default:i(()=>[s.value?(o(),c("div",{key:0,onClick:H(D,["stop"])},r(t.client),1)):(o(),c("div",Ie,r(t.client),1))]),_:1},8,["isHaveRArrow"]),t.status!==1?(o(),b(m,{key:1,label:"审核人"},{default:i(()=>[l("div",null,r(t.auditIdentifyName),1)]),_:1})):f("",!0),n(m,{label:"出车时间",isHaveRArrow:s.value,isRequire:s.value,onOnHandle:e[3]||(e[3]=v=>s.value?h(1):()=>{})},{default:i(()=>[l("div",{onClick:e[2]||(e[2]=H(v=>s.value?h(1):()=>{},["stop"]))},r(t.startTime),1)]),_:1},8,["isHaveRArrow","isRequire"]),n(m,{label:"结束时间",isHaveRArrow:s.value,isRequire:s.value,onOnHandle:e[5]||(e[5]=v=>s.value?h(2):()=>{})},{default:i(()=>[l("div",{onClick:e[4]||(e[4]=H(v=>s.value?h(2):()=>{},["stop"]))},r(t.endTime),1)]),_:1},8,["isHaveRArrow","isRequire"])]),ke,!s.value&&t.status===1?(o(),c("div",Ce,[n(y,{firBtnTxt:"删除记录",secBtnTxt:"修改记录",onOnFirBtnHandle:Q,onOnSecBtnHandle:j})])):f("",!0),s.value?(o(),c("div",xe,[n(x,{disable:U.value,handleTxt:"保存修改",onOnHandle:G},null,8,["disable"])])):f("",!0)]),n(g,{ref_key:"confirmPopRef",ref:C,popClass:"staff-edit-dialog-box",customFooter:!0,onOnConfirm:J},{default:i(()=>[He]),_:1},512),n(me,{ref_key:"feeTypePopRef",ref:B,title:"选择委派人",data:A.value,onOnChange:F},null,8,["data"]),n(w,{ref_key:"startTimeSelectRef",ref:S,onOnChangeVal:E},null,512),n(w,{ref_key:"endTimeSelectRef",ref:$,onOnChangeVal:z},null,512)]),_:1},8,["pageLoading"])}}});export{we as default};
