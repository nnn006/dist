import{d as k,g as u,m,o as B,a as T,B as n,i,Q as c,x as s,H as I,_ as F,r as N,L as $}from"./vue.BCHSKM6y.js";import{u as U,y as A,c as R,b as z,z as H,x as b,t as f,E,A as g,d as q}from"./index.Cjri3_sP.js";const L={class:"set-pwd-box hk-pt-52"},Q={class:"set-pwd-form"},W=["src"],Z=i("div",{class:"form-item-auxbox"},null,-1),j=["src"],G=i("div",{class:"form-item-auxbox"},null,-1),J=["src"],ee=k({__name:"updatePwd",setup(K){const h=F(),_=U(),{pushName:M,replacePath:V}=R();h.query;const{t:l}=z(),x=u(()=>l("base.setNewPwdTxt")),e=m({oldPwd:"",password:"",oncePwd:""}),r=m({oldPwdError:!1,passwordError:!1,oncePwdError:!1}),v=u(()=>e.oldPwd&&e.password&&e.oncePwd===e.password&&!r.passwordError&&!r.oncePwdError&&!r.oldPwdError),d=m({isPwdShow:!1,isOncePwdShow:!1,isOldPwd:!1}),p=u(()=>({oldPwdErr:["请输入旧密码"],pwdErr:[l("base.setPwdErrFir"),l("base.setPwdErrSec")],onceOwdErr:[l("base.setPwdErrTir")]})),y=()=>{const a=/.{8,16}/,o=/[a-zA-Z]/.test(e.password),w=/[0-9]/.test(e.password),t=/[\W_]/.test(e.password),S=(o?1:0)+(w?1:0)+(t?1:0);a.test(e.password)&&S>=2?r.passwordError=!1:r.passwordError=!0},O=()=>{e.oldPwd!==""?r.oldPwdError=!1:r.oldPwdError=!0},C=()=>{e.oncePwd!==""&&e.oncePwd===e.password?r.oncePwdError=!1:r.oncePwdError=!0},P=a=>{d[a]=!d[a]},D=()=>{H({oldPassword:e.oldPwd,newPassword:e.password}).then(async a=>{a.code===0?(b({message:"修改密码成功，请重新登录"}),await _.$reset(),V("/login")):b({message:a.msg,position:"top"})}).catch(a=>{b({message:a,position:"top"})})};return(a,o)=>{const w=N("FormItemPop");return B(),T(I,null,[n(A,{class:"set-pwd-header",title:x.value,comebackColor:"#0D0D0D"},null,8,["title"]),i("div",L,[i("div",Q,[n(w,{label:"旧密码",popVisible:r.oldPwdError,errorData:p.value.oldPwdErr},{default:c(()=>[n(s(f),{modelValue:e.oldPwd,"onUpdate:modelValue":o[1]||(o[1]=t=>e.oldPwd=t),type:d.isOldPwd?"text":"password",placeholder:s(l)("base.setPwdPld"),clearable:"","clear-icon":"cross",onBlur:O},{"right-icon":c(()=>[i("img",{class:"pwd-taggle-icon",src:d.isOldPwd?s(E):s(g),onClick:o[0]||(o[0]=t=>P("isOldPwd")),alt:""},null,8,W)]),_:1},8,["modelValue","type","placeholder"])]),_:1},8,["popVisible","errorData"]),Z,n(w,{label:s(l)("base.inputPwdTxt"),popVisible:r.passwordError,errorData:p.value.pwdErr},{default:c(()=>[n(s(f),{modelValue:e.password,"onUpdate:modelValue":o[3]||(o[3]=t=>e.password=t),type:d.isPwdShow?"text":"password",placeholder:s(l)("base.setPwdPld"),clearable:"","clear-icon":"cross",onBlur:y},{"right-icon":c(()=>[i("img",{class:"pwd-taggle-icon",src:d.isPwdShow?s(E):s(g),onClick:o[2]||(o[2]=t=>P("isPwdShow")),alt:""},null,8,j)]),_:1},8,["modelValue","type","placeholder"])]),_:1},8,["label","popVisible","errorData"]),G,n(w,{label:s(l)("base.confirmPwdTxt"),popVisible:r.oncePwdError,errorData:p.value.onceOwdErr},{default:c(()=>[n(s(f),{modelValue:e.oncePwd,"onUpdate:modelValue":o[5]||(o[5]=t=>e.oncePwd=t),type:d.isOncePwdShow?"text":"password",placeholder:s(l)("base.setPwdOncePld"),clearable:"","clear-icon":"cross",onBlur:C},{"right-icon":c(()=>[i("img",{class:"pwd-taggle-icon",src:d.isOncePwdShow?s(E):s(g),onClick:o[4]||(o[4]=t=>P("isOncePwdShow")),alt:""},null,8,J)]),_:1},8,["modelValue","type","placeholder"])]),_:1},8,["label","popVisible","errorData"])]),n(s(q),{class:"set-step-btn",disabled:!v.value,type:"primary",onClick:D},{default:c(()=>[$("保存")]),_:1},8,["disabled"])])],64)}}});export{ee as default};
