import{d as I,j as A,U as B,f as F,t as h,M as P,u as M,W as R,aw as j,a as z}from"./index.C__3lhMr.js";import{l as E,r as k,b as x,a as H,o as K,K as w,L as f,M as p,k as c,N as o,O as m,u as t,F as C,D as g,V as L}from"./vue.C2TeXnf4.js";const O={class:"register-box modify-pwd-box"},W={class:"reg-form-box"},$={class:"reg-form-item hk-flex hk-items-center"},q={class:"reg-area-span"},G={class:"reg-field-box"},J={class:"reg-form-item rf-mt-24 hk-flex hk-items-center"},Q={class:"reg-field-box"},oe=E({__name:"bindTel",setup(X){const{t:u}=M();let a=null;const{pushName:Y,comeback:V}=I(),{hkMessage:d}=z(),D=A(),v=k(null),e=x({account:"",verCode:""}),S=H(()=>!!e.account&&!!e.verCode),i=k(86),s=x({isCountdown:!1,countdownNum:60}),N=()=>{v.value.taggleVisible(!0)},b=B(()=>{if(!e.account){d("请填写手机号码");return}s.isCountdown||(s.isCountdown=!0,R({phone:"+"+i.value+e.account}).then(n=>{n.code===0?_():d(n.msg)}).catch(n=>{d(n)}))},500),_=()=>{a=setTimeout(()=>{s.countdownNum>=1?(s.countdownNum--,_()):(s.isCountdown=!1,s.countdownNum=60,clearTimeout(a),a=null)},1e3)},T=()=>{j({phone:"+"+i.value+e.account,code:e.verCode}).then(n=>{n.code===0?(d("绑定手机号成功"),D.updateUserInfo("contactInformation","+"+i.value+e.account),V()):d(n.msg)})};return K(()=>{a&&(clearTimeout(a),a=null)}),(n,l)=>{const y=w("SvgIcon"),U=w("AreaCodeSelect");return f(),p(C,null,[c(F,{class:"login-module-header",title:"绑定手机",comebackColor:"#0D0D0D"}),o("div",O,[o("div",W,[o("div",$,[o("div",{class:"reg-area hk-flex hk-items-center",onClick:N},[o("span",q,"+"+m(i.value),1),c(y,{iconClass:"down-select-svg",size:"9",color:"#0D0D0D"})]),o("div",G,[c(t(h),{modelValue:e.account,"onUpdate:modelValue":l[0]||(l[0]=r=>e.account=r),placeholder:t(u)("base.regTelPldtxt"),clearable:"","clear-icon":"cross"},null,8,["modelValue","placeholder"])])]),o("div",J,[o("div",Q,[c(t(h),{modelValue:e.verCode,"onUpdate:modelValue":l[1]||(l[1]=r=>e.verCode=r),placeholder:t(u)("base.regVerCodePldtxt"),clearable:"","clear-icon":"cross"},null,8,["modelValue","placeholder"])]),o("div",{class:"get-vcode-box",onClick:l[2]||(l[2]=(...r)=>t(b)&&t(b)(...r))},[s.isCountdown?(f(),p(C,{key:0},[g(m(s.countdownNum)+" ",1),o("span",null,m(t(u)("base.vCodeSendTxt")),1)],64)):(f(),p(C,{key:1},[g(m(t(u)("base.getVcodeTxt")),1)],64))])])]),c(t(P),{class:"reg-step-btn",disabled:!S.value,type:"primary",onClick:T},{default:L(()=>[g("绑定")]),_:1},8,["disabled"])]),c(U,{ref_key:"areaCodeSelectRef",ref:v},null,512)],64)}}});export{oe as default};
