import{d as P,l as S,m as z,g as H,p as A,o as V,e as q,Q as p,x as f,Z as E,_ as J,r as m,i as a,B as n,S as T}from"./vue.BCHSKM6y.js";import{b as $,a0 as j,a1 as Q,g as Z}from"./index.Cjri3_sP.js";import{_ as F}from"./NewsItem.vue_vue_type_style_index_0_lang.CsWKk6Rr.js";import{u as G}from"./useConfigBaseInfo.D5J8WFky.js";const K={class:"data-review-box hk-pt-104"},U={class:"screen-box hk-flex hk-w-full"},W={class:"screen-item"},X={class:"hk-flex hk-items-center"},Y={class:"news-select-value"},ee={class:"screen-item"},se={class:"hk-flex hk-items-center"},te={class:"news-select-value"},ae={class:"screen-item"},oe={class:"news-main-box"},ne=["src"],me=P({__name:"index",setup(ie){const{t:y}=$(),{hkMessage:w}=Z(),C=E();J().query;const _=S(null),h=S([]),s=z({page:1,pageSize:10,total:0,curTime:0,allPayMoney:0,currency:""}),x=H(()=>[{text:"全部消息",value:0},{text:y("base.screen.msgClass.pay"),value:1},{text:y("base.screen.msgClass.car"),value:3}]),c=S({text:"全部消息",value:0}),k=t=>{g.home=t,s.page=1,r()},L=t=>{c.value=t,s.page=1,r()},r=()=>new Promise(t=>{var d;const i={page:s.page,pageSize:s.pageSize,homeId:g.home.value,selectTime:Math.floor(s.curTime/1e3),selectTimeTyp:2,typ:((d=c.value)==null?void 0:d.value)||0};Q(i).then(o=>{if(o.code===0){const l=o.data.list.map(e=>({id:e.applicationId,title:e.title,value:e.typ===3?e.useCarTime:e.amount,type:e.typ===1?"price":e.typ===3?"time":"text",currencyType:e.currency,pic:e.identifyAvatar,applyState:e.status,active:!1,homeName:e.homeName,identifyName:e.identifyName,applicationTime:e.applicationTime,endTime:e.endTime,startTime:e.startTime,status:e.status,useCarTime:e.useCarTime,typ:e.typ}));s.page===1?h.value=l:h.value.push(...l),s.total=o.data.total}else w(o.msg)}).finally(()=>{var o,l;(o=_.value)==null||o.taggleRefreshState("isLoading",!1),(l=_.value)==null||l.taggleRefreshState("loading",!1),t(!0)})}),D=()=>{s.page=1,r()},{homeSelectData:R,screenVal:g,pageLoading:M}=G({loadList:async()=>{s.page=1,await r()}}),b=t=>{window.sessionStorage.setItem("statisticDetails",JSON.stringify({home:g.home,time:s.curTime,msg:c.value})),C.push({name:"PayDetails",query:{id:t.id}})},I=()=>{s.page++,r()},O=t=>{s.curTime=new Date(t).getTime(),s.page=1,r()};return A(()=>{const t=window.sessionStorage.getItem("statisticDetails");if(t){const i=JSON.parse(t);i.time&&(s.curTime=i.time),i.msg&&(c.value=i.msg)}}),(t,i)=>{const d=m("SvgIcon"),o=m("HkPopover"),l=m("MonthSelect"),e=m("SecondHeader"),N=m("DownRefresh"),B=m("MainContainer");return V(),q(B,{exitLoading:!0,pageLoading:f(M)},{default:p(()=>[a("div",K,[n(e,null,{default:p(()=>{var u;return[a("div",U,[a("div",W,[n(o,{options:f(R),value:f(g).home.value,pannelClass:"news-minw-168",placement:"bottom-start",offset:[0,18],isSelectState:!0,onOnChange:k},{taggleEle:p(()=>[a("div",X,[a("span",Y,T(f(g).home.text),1),n(d,{iconClass:"down-select-svg",size:"9",color:"#ffffff"})])]),_:1},8,["options","value"])]),a("div",ee,[n(o,{options:x.value,value:(u=c.value)==null?void 0:u.value,pannelClass:"news-minw-168",placement:"bottom",offset:[0,18],onOnChange:L,isSelectState:!0,isSplitBorder:[0]},{taggleEle:p(()=>{var v;return[a("div",se,[a("span",te,T(((v=c.value)==null?void 0:v.text)||"消息分类"),1),n(d,{iconClass:"down-select-svg",size:"9",color:"#ffffff"})])]}),_:1},8,["options","value"])]),a("div",ae,[n(l,{isAll:s.curTime===0,value:s.curTime,onOnTimeChange:O},null,8,["isAll","value"])])])]}),_:1}),a("div",oe,[n(N,{ref_key:"downRefreshRef",ref:_,dataList:h.value,pagination:s,onOnRefresh:D,onOnLoad:I},{default:p(({data:u})=>[n(F,{data:u,onClick:v=>b(u)},{examineState:p(()=>[a("img",{class:"msg-state-img",src:f(j)(u.status),alt:"",srcset:""},null,8,ne)]),_:2},1032,["data","onClick"])]),_:1},8,["dataList","pagination"])])])]),_:1},8,["pageLoading"])}}});export{me as default};
