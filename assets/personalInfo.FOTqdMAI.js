import{h as Y,a3 as E,u as V,a as q,b as F,c as z,af as Q,d as G,y as J,a6 as K,e as x,g as W,ag as X,ah as Z}from"./index.Cjri3_sP.js";import{d as ee,l as _,m as ae,p as te,o as p,e as oe,Q as i,x as e,_ as se,j as ne,r as m,B as n,a5 as ie,L as ce,i as o,S as c,a as P}from"./vue.BCHSKM6y.js";import{_ as u}from"./BaseInfoItem.vue_vue_type_style_index_0_lang.DMYgpoJW.js";import"./right-arrow-icon.CaFxgYzl.js";const le={class:"add-home-box hk-flex hk-flex-col container-setPx"},fe={class:"add-home-form"},de={class:"staff-details-info"},re={key:0,class:"staff-details-info"},me={class:"staff-details-info"},ue={class:"staff-details-info"},ge={class:"staff-info-item"},_e={class:"staff-info-title"},pe=["src"],he=o("div",{class:"footer-aux-btmbox"},null,-1),ve={class:"footer-btn-box"},be=o("div",{class:"staff-details-dialog"},[o("div",{class:"pd-dialog-content"}," 确定注销账号? ")],-1),Ce=ee({name:"PersonalInfo",__name:"personalInfo",setup(Ie){const{t:f}=F(),y=se(),{id:B,homeId:C}=y.query,{hkMessage:l}=W(),{auth:w}=Y(),S=E(),d=V(),g=ne("doViewsCache"),h=_(null),{pushName:r,comeback:ke,replacePath:T}=z(),{pageLoading:L,endPageLoading:v}=q({activeAction:A}),b=_(null),I=_(!0),a=ae({nickname:"",avatar:"",birthday:"",contactInformation:"",joinTime:0}),k=s=>{Q().then(t=>{t.code===0?(a.avatar=t.data.avatar,a.nickname=t.data.nickname,a.birthday=t.data.birthday,a.contactInformation=t.data.contactInformation,a.joinTime=t.data.joinTime):l(t.msg)}).finally(()=>{I.value=!1,s&&s()})},M=()=>{r("PersonalInfoEdit",{id:B,homeId:C})},j=()=>{b.value.taggleModal()};async function A(){k(v)}const H=()=>{X().then(s=>{s.code===0?h.value.taggleDialog(!0):l(s.msg)}).catch(s=>{l(s)})},R=()=>{Z().then(async s=>{s.code===0?(l("账号注销成功"),g==null||g(),await d.$reset(),await S.$reset(),sessionStorage.clear(),localStorage.clear(),d.updateUserInfo("homeSimple",[]),T("/login")):l(s.msg)})};return te(()=>{k(v)}),(s,t)=>{const $=m("BaseHandleBtn"),D=m("PreviewImage"),N=m("ConfrimPopAgain"),O=m("MainContainer");return p(),oe(O,{exitLoading:!0,pageLoading:e(L)},{default:i(()=>[n(J,{title:"个人资料"},ie({_:2},[e(w)===1?{name:"rightContent",fn:i(()=>[n(e(G),{size:"mini",class:"staff-quit-btn",onClick:H},{default:i(()=>[ce("注销账号")]),_:1})]),key:"0"}:void 0]),1024),o("div",le,[o("div",fe,[n(u,{label:e(f)("base.nameTxt")},{default:i(()=>[o("div",de,c(a.nickname),1)]),_:1},8,["label"]),n(u,{label:e(f)("base.telNotxt")},{default:i(()=>[a.contactInformation?(p(),P("div",re,c(a.contactInformation),1)):(p(),P("div",{key:1,class:"staff-details-info to-banding-tel",onClick:t[0]||(t[0]=U=>e(r)("BindingTel"))},c(I.value?"":"绑定手机"),1))]),_:1},8,["label"]),n(u,{label:e(f)("base.birthdayTxt")},{default:i(()=>[o("div",me,c(a.birthday),1)]),_:1},8,["label"]),n(u,{label:"注册时间"},{default:i(()=>[o("div",ue,c(e(K)(a.joinTime*1e3).format("YYYY-MM-DD HH:mm")),1)]),_:1}),o("div",ge,[o("div",_e,c(e(f)("base.pictrueTxt")),1),o("img",{class:"staff-info-img",src:e(x)+a.avatar,onClick:j},null,8,pe)])]),he,o("div",ve,[n($,{firBtnTxt:e(d).userInfo.isSetPassword?"修改密码":"设置密码",secBtnTxt:"编辑资料",onOnFirBtnHandle:t[1]||(t[1]=U=>e(d).userInfo.isSetPassword?e(r)("UpdatePwd"):e(r)("SetPwd",{type:1})),onOnSecBtnHandle:M},null,8,["firBtnTxt"])])]),n(D,{ref_key:"previewImgRef",ref:b,imageList:[e(x)+a.avatar]},null,8,["imageList"]),n(N,{ref_key:"confirmPopRef",ref:h,popClass:"staff-details-dialog-box",customFooter:!0,onOnConfirm:R},{default:i(()=>[be]),_:1},512)]),_:1},8,["pageLoading"])}}});export{Ce as default};
