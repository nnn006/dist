import{b as w,e as F,B as H,j as O,ad as U,a6 as z,Q as A,u as E,y as P,c as Q,t as S,g as q}from"./index.Cjri3_sP.js";import{d as D,l as u,o as $,a as R,i as e,B as i,Q as b,x as t,S as m,m as I,g as G,p as J,L as K,H as W,r as x}from"./vue.BCHSKM6y.js";import{e as X,f as Y}from"./index.DllRNd8O.js";import{_ as Z}from"./BaseInfoItem.vue_vue_type_style_index_0_lang.DMYgpoJW.js";import"./right-arrow-icon.CaFxgYzl.js";const ee={class:"aplimp-item-box hk-flex"},te={class:"aplimp-item-l"},ae=["src"],se={class:"aplimp-item-r"},oe={class:"hk-flex hk-jbetween aplimp-item-rt"},le={class:"aplimp-item-val-fbox hk-flex hk-items-center"},ne={class:"aplimp-item-val-box"},ie={class:"aplimp-item-cury"},ce={class:"hk-flex hk-jbetween aplimp-item-rmbox"},re={class:"aplimp-item-rb"},de=["src"],pe=D({__name:"applyItem",props:{data:{default:()=>({})}},setup(B){w();const r=u(!1);return(c,_)=>($(),R("div",ee,[e("div",te,[i(t(H),{dot:"",offset:["-3px","4px"],color:r.value?"#FF4938":"transparent"},{default:b(()=>[e("img",{class:"aplimp-item-img",src:t(F)+c.data.pic,srcset:""},null,8,ae)]),_:1},8,["color"])]),e("div",se,[e("div",oe,[e("div",null,m(c.data.title),1),e("div",le,[e("div",ne,[i(t(U),{class:"aplimp-item-value hk-fw-600",rows:"1",content:t(O)(c.data.price)},null,8,["content"])]),e("span",ie,m(c.data.currency),1)])]),e("div",ce,[e("div",re,m(t(z)(c.data.time).format("MM-DD HH:mm")),1),e("img",{class:"aplimp-status-img",src:t(A)(c.data.state===1?"wait":c.data.state===2?"pass":"unpass"),alt:""},null,8,de)])])]))}}),me={class:"imprest-do-box imprest-apply-box hk-flex hk-flex-col hk-pt-52"},ue={class:"pay-handle-box"},he={class:"pay-handle-from form-pt-8"},fe={class:"hk-flex hk-items-center"},_e={class:"form-item-price-util"},ge={class:"form-textarea-box"},ve={class:"hk-flex hk-jbetween hk-items-center form-textarea-t"},ye={class:"form-textarea-tl"},xe={class:"form-textarea-tr"},be={class:"form-textarea-b"},ke={class:"imp-apply-lsbox"},Te={class:"apply-record-header hk-flex hk-items-center hk-jbetween"},Se=e("span",{class:"apply-record-headerl"},"申请记录",-1),Ie={class:"imprest-apply-list"},Ve=D({__name:"apply",setup(B){const{t:r}=w(),{pushName:c}=Q(),{hkMessage:_}=q(),h=E(),g=u(!1),v=u(null),a=I({money:"",desc:""}),k=u(""),L=G(()=>!!a.money&&Number(a.money)>0),l=I({page:1,pageSize:10,total:0,curTime:new Date().getTime()}),y=u([]),f=()=>{const s={page:l.page,pageSize:l.pageSize,selectTime:Math.floor(l.curTime/1e3),selectTimeTyp:2,homeId:h.userInfo.homeId,identifyId:h.userInfo.identifyId};X(s).then(o=>{if(o.code===0){const d=o.data.list.map(n=>({title:"申请备用金",pic:n.identifyAvatar,job:"",time:n.applicationTime*1e3,homeName:n.homeName,id:n.applicationId,homeId:n.homeId,price:n.amount,currency:n.currency,state:n.status}));l.page===1?y.value=d:y.value.push(...d),l.total=o.data.total}}).finally(()=>{var o,d;(o=v.value)==null||o.taggleRefreshState("isLoading",!1),(d=v.value)==null||d.taggleRefreshState("loading",!1)})},V=()=>{l.page++,f()},T=()=>{l.page=1,f()},M=s=>{l.curTime=new Date(s).getTime(),l.page=1,f()},N=()=>{g.value=!0,Y({homeId:h.userInfo.homeId,amount:a.money,remark:a.desc}).then(s=>{s.code===0?(T(),_("申请已提交"),a.desc="",a.money=""):_(s.msg)}).finally(()=>{g.value=!1})},j=s=>s.replace(/[^0-9.,]/g,"");return J(async()=>{const s=await h.getSurplusRes;k.value=s.currency,f()}),(s,o)=>{const d=x("BtmSingleBtn"),n=x("MonthSelect"),C=x("DownRefresh");return $(),R(W,null,[i(P,{title:t(r)("base.footer.imprest",{pre:t(r)("base.applyTxt")})},null,8,["title"]),e("div",me,[e("div",ue,[e("div",he,[i(Z,{label:"申请金额",isRequire:!0},{default:b(()=>[e("div",fe,[i(t(S),{class:"form-item-price",modelValue:a.money,"onUpdate:modelValue":o[0]||(o[0]=p=>a.money=p),formatter:j,type:"number",placeholder:"0"},null,8,["modelValue"]),e("span",_e,m(k.value),1)])]),_:1}),e("div",ge,[e("div",ve,[e("div",ye,m(t(r)("base.descTxt")),1),e("div",xe,[e("span",null,m(a.desc.length),1),K("/200")])]),e("div",be,[i(t(S),{class:"form-textarea",maxlength:200,rows:"6",modelValue:a.desc,"onUpdate:modelValue":o[1]||(o[1]=p=>a.desc=p),placeholder:t(r)("base.descTxt")+":",type:"textarea"},null,8,["modelValue","placeholder"])])])]),i(d,{class:"imp-do-btn",loading:g.value,disable:L.value,handleTxt:t(r)("base.applyTxt"),onOnHandle:N},null,8,["loading","disable","handleTxt"])]),e("div",ke,[e("div",Te,[Se,i(n,{onOnTimeChange:M,iconColor:"#0D0D0D"})]),e("div",Ie,[i(C,{ref_key:"downRefreshRef",ref:v,dataList:y.value,pagination:l,onOnRefresh:T,onOnLoad:V},{default:b(({data:p})=>[i(pe,{data:p,onClick:we=>t(c)("StaffImpDetails",{id:p.id})},null,8,["data","onClick"])]),_:1},8,["dataList","pagination"])])])])],64)}}});export{Ve as default};
