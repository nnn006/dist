import{d as Z,m as ee,l as r,g as te,p as ae,o as u,a as S,i as o,B as n,Q as m,x as s,e as w,f as x,S as c,L as B,H as se,_ as oe,r as p,a6 as D}from"./vue.BCHSKM6y.js";import{I as ne,a3 as le,a4 as re,b as ce,c as ie,t as T,a7 as de,a8 as ue,g as me}from"./index.Cjri3_sP.js";import{_ as f}from"./BaseInfoItem.vue_vue_type_style_index_0_lang.DMYgpoJW.js";import"./right-arrow-icon.CaFxgYzl.js";const pe={class:"pay-handle-box container-setPx hk-flex hk-flex-col hk-pt-52"},fe={class:"pay-handle-from"},ge={class:"hk-flex hk-items-center"},ye={class:"form-item-price-util"},_e={class:"form-textarea-box"},he={class:"hk-flex hk-jbetween hk-items-center form-textarea-t"},xe={class:"form-textarea-tl"},Te={class:"form-textarea-tr"},be={class:"form-textarea-b"},ve={class:"form-upload-img-box"},ke={class:"form-upload-img-tit"},Ie=o("span",null,"*",-1),Re={key:0,class:"form-upload-img"},Ve=o("div",{class:"footer-aux-btmbox"},null,-1),Ce={class:"footer-btn-box"},He=Z({__name:"index",setup(Me){const{t:l}=ce(),{hkMessage:b}=me(),{comeback:H}=ie(),t=ee({payMoney:"",gasType:"",gasId:"",consigner:"",desc:"",payTime:""}),g=oe(),{homeId:A}=g.query,L=r(g.query.currency),y=r(!1),v=ne.inApp(),i=new Date,q=i.getFullYear(),O=i.getMonth(),U=i.getDate(),$=i.getHours(),N=i.getMinutes(),P=r(Number(g.query.payType)),F=le(),_=r(null),k=r(null);r([]);const I=r(!1),h=r(null),R=r([]),Y=te(()=>!!t.payMoney&&Number(t.payMoney)>0&&!!t.gasType&&!!t.payTime&&I.value),V=()=>{_.value.taggleVisible()},C=()=>{k.value.taggleVisible(!0)},j=(e,a)=>{t.payTime=`${e[0]}-${e[1]}-${e[2]} ${a[0]}:${a[1]}`},E=e=>{t.gasType=e==null?void 0:e[0].text,t.gasId=e==null?void 0:e[0].value},Q=e=>{de({homeId:A,amount:+t.payMoney,expenseTypeId:+t.gasId,remark:t.desc,payTime:ue(t.payTime),photos:e}).then(a=>{a.code===0?(b("支出成功"),H()):b(a.msg)}).finally(()=>{y.value=!1})},z=()=>{var a;y.value=!0;const e=(a=h.value)==null?void 0:a.getValues();Q(e)},M=e=>{I.value=e},G=e=>{let a=e.replace(/[^0-9.,]/g,"");return e.match(/\d+(\.\d{0,2})?/)&&(a=a.match(/\d+(\.\d{0,2})?/)[0]),a};return ae(async()=>{var e;R.value=await F.getCostType,t.payTime=(e=_.value)==null?void 0:e.getCurrTime()}),(e,a)=>{const J=p("UploadImg"),K=p("AppUploadImg"),W=p("BtmSingleBtn"),X=p("TimeSelect");return u(),S(se,null,[o("div",pe,[o("div",fe,[n(f,{label:s(l)("base.payMoneyTxt"),isRequire:!0},{default:m(()=>[o("div",ge,[n(s(T),{class:"form-item-price",modelValue:t.payMoney,"onUpdate:modelValue":a[0]||(a[0]=d=>t.payMoney=d),formatter:G,type:"number",placeholder:"0"},null,8,["modelValue"]),o("span",ye,c(L.value),1)])]),_:1},8,["label"]),n(f,{label:s(l)("base.gasTypeTxt"),isHaveRArrow:!0,isRequire:!0,onOnHandle:C},{default:m(()=>[o("div",{onClick:D(C,["stop"])},c(t.gasType),1)]),_:1},8,["label"]),P.value===1?(u(),w(f,{key:0,label:s(l)("base.consignerTxt"),isRequire:!0},{default:m(()=>[n(s(T),{modelValue:t.consigner,"onUpdate:modelValue":a[1]||(a[1]=d=>t.consigner=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1},8,["label"])):x("",!0),n(f,{label:s(l)("base.payTimeTxt"),isHaveRArrow:!0,isRequire:!0,onOnHandle:V},{default:m(()=>[o("div",{onClick:D(V,["stop"])},c(t.payTime),1)]),_:1},8,["label"]),o("div",_e,[o("div",he,[o("div",xe,c(s(l)("base.descTxt")),1),o("div",Te,[o("span",null,c(t.desc.length),1),B("/200")])]),o("div",be,[n(s(T),{class:"form-textarea",maxlength:200,rows:"6",modelValue:t.desc,"onUpdate:modelValue":a[2]||(a[2]=d=>t.desc=d),placeholder:s(l)("base.descTxt")+":",type:"textarea"},null,8,["modelValue","placeholder"])])]),o("div",ve,[o("div",ke,[B(c(s(l)("base.pictrueTxt")),1),Ie]),s(v)?x("",!0):(u(),S("div",Re,[n(J,{ref_key:"uploadImgRef",ref:h,maxCount:6,onOnChangeIsLength:M},null,512)])),s(v)?(u(),w(K,{key:1,ref_key:"uploadImgRef",ref:h,maxCount:6,onOnChangeImg:M},null,512)):x("",!0)])]),Ve,o("div",Ce,[n(W,{loading:y.value,disable:Y.value,handleTxt:s(l)("base.btn.pay"),onOnHandle:z},null,8,["loading","disable","handleTxt"])])]),n(X,{ref_key:"timeSelectRef",ref:_,maxLimit:new Date(s(q),s(O),s(U)),maxTimeLimit:[s($),s(N)],onOnChangeVal:j},null,8,["maxLimit","maxTimeLimit"]),n(re,{ref_key:"feeTypePopRef",ref:k,title:s(l)("base.selectFeeTpTxt"),data:R.value,onOnChange:E},null,8,["title","data"])],64)}}});export{He as default};
