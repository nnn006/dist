import{d as de,l as i,m as ue,g as re,p as me,o as x,a as L,B as s,x as o,i as l,Q as u,L as V,S as r,f as B,e as fe,H as pe,_ as ge,j as he,r as m,a6 as O}from"./vue.BCHSKM6y.js";import{I as _e,a3 as be,u as ve,y as ye,a4 as Ie,b as xe,c as ke,aA as Se,e as Te,aB as Ce,t as Me,a6 as Re,g as De,ai as we}from"./index.Cjri3_sP.js";import{_ as f}from"./BaseInfoItem.vue_vue_type_style_index_0_lang.DMYgpoJW.js";import{A as Ae}from"./index.YYOoEeNT.js";import"./right-arrow-icon.CaFxgYzl.js";const He={class:"updata-staff-box hk-flex hk-flex-col container-setPx"},Le={class:"updata-staff-form"},Ve={class:"info-no-input"},Be={class:"info-no-input"},Oe={class:"form-upload-img-box"},Pe={class:"form-upload-img-tit"},Ue=l("span",null,"*",-1),Ne={key:0,class:"form-upload-img"},je=l("div",{class:"footer-aux-btmbox"},null,-1),Fe={class:"footer-btn-box"},Ye={class:"staff-edit-dialog"},$e={class:"pd-dialog-content"},qe=l("p",null,"提示：请勿忘记线下收回备用金",-1),We=de({__name:"editDetails",setup(Je){const{t:n}=xe(),g=i([]),P=ge(),h=new Date,U=he("endPageLoading"),k=_e.inApp(),N=h.getFullYear(),j=h.getMonth(),F=h.getDate(),Y=i(null),S=i(null),$=i(null),q=be(),T=ve(),_=i(!1),C=i([]),p=i([]),{comeback:J,goback:E}=ke(),{hkMessage:c}=De(),{id:b,homeId:Q}=P.query,M=i(null),R=i(!0),v=i(null),y=i(!1),a=ue({nickname:"",avatar:"",homeName:"",birthday:"",contactInformation:"",identifyMsgId:"",duties:"",country:"",joinTime:0,countryId:0,dutiesId:0}),z=re(()=>!!a.nickname&&!!a.birthday&&R.value),G=t=>{a.country=t.countryName,a.countryId=t.countryId},K=t=>{Se({identifyId:+b}).then(e=>{e.code===0?(a.avatar=e.data.avatar,a.nickname=e.data.nickname,a.homeName=e.data.homeName,a.birthday=e.data.birthday,a.contactInformation=e.data.contactInformation,a.identifyMsgId=e.data.identifyMsgId,a.country=e.data.country,a.duties=e.data.duties,a.joinTime=e.data.joinTime,a.countryId=e.data.countryId,a.dutiesId=e.data.dutiesId,g.value=[{url:Te+e.data.avatar,baseUrl:e.data.avatar}],p.value=e.data.familyMemberHomeList.map(d=>d.homeId)):c(e.msg)}).finally(()=>{t&&t()})},D=i([]),W=()=>{y.value=!1},X=t=>{a.duties=t.name,a.dutiesId=t.value},w=()=>{S.value.taggleVisible()},Z=t=>{a.birthday=`${t[0]}-${t[1]}-${t[2]}`},ee=t=>{we({identifyId:+b,nickname:a.nickname,avatar:t,birthday:a.birthday,contactInformation:a.contactInformation,identifyMsgId:a.identifyMsgId,countryId:a.countryId,homeIds:p.value}).then(e=>{e.code===0?(c("保存成功"),J()):c(e.msg)}).catch(e=>{c(e)}).finally(()=>{_.value=!1})},ae=()=>{var e;_.value=!0;const t=(e=v.value)==null?void 0:e.getValues();ee(t[0])},te=t=>{p.value=t.map(e=>e.value)},A=()=>{M.value.taggleVisible(!0)},oe=()=>{Ce({identifyId:+b,homeId:+Q}).then(t=>{t.code===0?(c("离职成功"),E(-2)):c(t.msg)}).catch(t=>{c(t)})},H=t=>{R.value=t};return me(async()=>{K(U);const t=await q.getJob;D.value=t.map(d=>({name:d.text,value:d.value})),await T.setHomeSimpleLs();const e=await T.homeSimple;C.value.push(...e)}),(t,e)=>{const d=m("UploadImg"),ne=m("AppUploadImg"),se=m("BtmSingleBtn"),le=m("ConfrimPopAgain"),ie=m("AreaSelect"),ce=m("DateSelect");return x(),L(pe,null,[s(ye,{title:o(n)("base.familyDetails",{do:o(n)("base.editTxt")})},null,8,["title"]),l("div",He,[l("div",Le,[s(f,{label:o(n)("base.nameTxt"),isRequire:!0},{default:u(()=>[s(o(Me),{modelValue:a.nickname,"onUpdate:modelValue":e[0]||(e[0]=I=>a.nickname=I),placeholder:o(n)("base.pleaseInputTxt")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(f,{label:o(n)("base.telNotxt")},{default:u(()=>[l("div",Ve,r(a.contactInformation),1)]),_:1},8,["label"]),s(f,{label:o(n)("base.birthdayTxt"),isHaveRArrow:!0,isRequire:!0,onOnHandle:w},{default:u(()=>[l("div",{onClick:O(w,["stop"])},r(a.birthday),1)]),_:1},8,["label"]),s(f,{label:o(n)("base.registerTimeTxt")},{default:u(()=>[l("div",Be,r(o(Re)(a.joinTime*1e3).format("YYYY-MM-DD HH:mm")),1)]),_:1},8,["label"]),s(f,{label:o(n)("base.manageFamilyTxt"),isHaveRArrow:!0,onOnHandle:A},{default:u(()=>[l("div",{class:"staff-details-clickview",onClick:O(A,["stop"])},r(o(n)("base.selectFamilyTxt")),1)]),_:1},8,["label"]),l("div",Oe,[l("div",Pe,[V(r(o(n)("base.pictrueTxt")),1),Ue]),o(k)?B("",!0):(x(),L("div",Ne,[s(d,{ref_key:"uploadImgRef",ref:v,fileValues:g.value,maxCount:1,onOnChangeIsLength:H},null,8,["fileValues"])])),o(k)?(x(),fe(ne,{key:1,ref_key:"uploadImgRef",ref:v,value:g.value,onOnChangeImg:H},null,8,["value"])):B("",!0)])]),je,l("div",Fe,[s(se,{disable:z.value,loading:_.value,handleTxt:o(n)("base.btn.save"),onOnHandle:ae},null,8,["disable","loading","handleTxt"])])]),s(o(Ae),{class:"hk-action-sheet",show:y.value,"onUpdate:show":e[1]||(e[1]=I=>y.value=I),actions:D.value,"cancel-text":"取消","close-on-click-action":"",onCancel:W,onSelect:X},null,8,["show","actions"]),s(Ie,{ref_key:"feeTypePopRef",ref:M,title:o(n)("base.manageFamilyTxt"),isSingle:!1,showBtmBtn:!0,value:p.value,data:C.value,onOnChange:te},null,8,["title","value","data"]),s(le,{ref_key:"confirmPopRef",ref:$,popClass:"staff-edit-dialog-box",customFooter:!0,onOnConfirm:oe},{default:u(()=>[l("div",Ye,[l("div",$e,[V(r(o(n)("base.confirmDelStaff"))+" ",1),qe])])]),_:1},512),s(ie,{ref_key:"areaSelectRef",ref:Y,title:o(n)("base.countryTxt"),onOnChange:G},null,8,["title"]),s(ce,{ref_key:"dateSelectRef",ref:S,maxLimit:new Date(o(N),o(j),o(F)),onOnChangeVal:Z},null,8,["maxLimit"])],64)}}});export{We as default};
