import{l as Z,b as ee,R as te,r,a as ae,d as se,K as u,L as p,U as x,V as m,N as o,k as n,u as s,O as c,a6 as D,S as T,D as q,M as oe}from"./vue.C2TeXnf4.js";import{d as ne,s as le,I as re,q as ce,t as b,k as ie,u as de,au as ue,av as me,a as pe}from"./index.C__3lhMr.js";import{_ as f}from"./BaseInfoItem.vue_vue_type_style_index_0_lang.MpSsZcmr.js";import"./right-arrow-icon.CaFxgYzl.js";const fe={class:"pay-handle-box container-setPx hk-flex hk-flex-col hk-pt-52"},ge={class:"pay-handle-from"},ye={class:"hk-flex hk-items-center"},_e={class:"form-item-price-util"},he={class:"form-textarea-box"},xe={class:"hk-flex hk-jbetween hk-items-center form-textarea-t"},Te={class:"form-textarea-tl"},be={class:"form-textarea-tr"},ve={class:"form-textarea-b"},ke={class:"form-upload-img-box"},Re={class:"form-upload-img-tit"},Ie=o("span",null,"*",-1),Ve={key:0,class:"form-upload-img"},Me=o("div",{class:"footer-aux-btmbox"},null,-1),Ce={class:"footer-btn-box"},Be=Z({__name:"index",setup(Se){const{t:l}=de(),{hkMessage:v}=pe(),{comeback:A}=ne(),{getCostType:B}=le(),t=ee({payMoney:"",gasType:"",gasId:"",consigner:"",desc:"",payTime:""}),g=te(),{homeId:k}=g.query,H=r(g.query.currency),y=r(!1),R=re.inApp(),i=new Date,L=i.getFullYear(),O=i.getMonth(),U=i.getDate(),N=i.getHours(),$=i.getMinutes(),P=r(Number(g.query.payType));ce();const _=r(null),I=r(null);r([]);const V=r(!1),h=r(null),M=r([]),F=ae(()=>!!t.payMoney&&Number(t.payMoney)>0&&!!t.gasType&&!!t.payTime&&V.value),C=()=>{_.value.taggleVisible()},S=()=>{I.value.taggleVisible(!0)},Y=(e,a)=>{t.payTime=`${e[0]}-${e[1]}-${e[2]} ${a[0]}:${a[1]}`},j=e=>{t.gasType=e==null?void 0:e[0].text,t.gasId=e==null?void 0:e[0].value},E=e=>{ue({homeId:k,amount:+t.payMoney,expenseTypeId:+t.gasId,remark:t.desc,payTime:me(t.payTime),photos:e}).then(a=>{a.code===0?(v("支出成功"),A()):v(a.msg)}).finally(()=>{y.value=!1})},G=()=>{var a;y.value=!0;const e=(a=h.value)==null?void 0:a.getValues();E(e)},w=e=>{V.value=e},K=e=>{let a=e.replace(/[^0-9.,]/g,"");return e.match(/\d+(\.\d{0,2})?/)&&(a=a.match(/\d+(\.\d{0,2})?/)[0]),a};return se(async()=>{var e;M.value=await B(k),t.payTime=(e=_.value)==null?void 0:e.getCurrTime()}),(e,a)=>{const z=u("UploadImg"),J=u("AppUploadImg"),Q=u("BtmSingleBtn"),W=u("TimeSelect"),X=u("MainContainer");return p(),x(X,null,{default:m(()=>[o("div",fe,[o("div",ge,[n(f,{label:s(l)("base.payMoneyTxt"),isRequire:!0},{default:m(()=>[o("div",ye,[n(s(b),{class:"form-item-price",modelValue:t.payMoney,"onUpdate:modelValue":a[0]||(a[0]=d=>t.payMoney=d),formatter:K,type:"number",placeholder:"0"},null,8,["modelValue"]),o("span",_e,c(H.value),1)])]),_:1},8,["label"]),n(f,{label:s(l)("base.gasTypeTxt"),isHaveRArrow:!0,isRequire:!0,onOnHandle:S},{default:m(()=>[o("div",{onClick:D(S,["stop"])},c(t.gasType),1)]),_:1},8,["label"]),P.value===1?(p(),x(f,{key:0,label:s(l)("base.consignerTxt"),isRequire:!0},{default:m(()=>[n(s(b),{modelValue:t.consigner,"onUpdate:modelValue":a[1]||(a[1]=d=>t.consigner=d),placeholder:"请输入"},null,8,["modelValue"])]),_:1},8,["label"])):T("",!0),n(f,{label:s(l)("base.payTimeTxt"),isHaveRArrow:!0,isRequire:!0,onOnHandle:C},{default:m(()=>[o("div",{onClick:D(C,["stop"])},c(t.payTime),1)]),_:1},8,["label"]),o("div",he,[o("div",xe,[o("div",Te,c(s(l)("base.descTxt")),1),o("div",be,[o("span",null,c(t.desc.length),1),q("/200")])]),o("div",ve,[n(s(b),{class:"form-textarea",maxlength:200,rows:"6",modelValue:t.desc,"onUpdate:modelValue":a[2]||(a[2]=d=>t.desc=d),placeholder:s(l)("base.descTxt")+":",type:"textarea"},null,8,["modelValue","placeholder"])])]),o("div",ke,[o("div",Re,[q(c(s(l)("base.pictrueTxt")),1),Ie]),s(R)?T("",!0):(p(),oe("div",Ve,[n(z,{ref_key:"uploadImgRef",ref:h,maxCount:6,onOnChangeIsLength:w},null,512)])),s(R)?(p(),x(J,{key:1,ref_key:"uploadImgRef",ref:h,maxCount:6,onOnChangeImg:w},null,512)):T("",!0)])]),Me,o("div",Ce,[n(Q,{loading:y.value,disable:F.value,handleTxt:s(l)("base.btn.pay"),onOnHandle:G},null,8,["loading","disable","handleTxt"])])]),n(W,{ref_key:"timeSelectRef",ref:_,maxLimit:new Date(s(L),s(O),s(U)),maxTimeLimit:[s(N),s($)],onOnChangeVal:Y},null,8,["maxLimit","maxTimeLimit"]),n(ie,{ref_key:"feeTypePopRef",ref:I,title:s(l)("base.selectFeeTpTxt"),data:M.value,onOnChange:j},null,8,["title","data"])]),_:1})}}});export{Be as default};
