import{m as H,q as O,j as Y,d as E,c as V,f as q,o as x,n as z,u as F,ax as K,ay as G,a as J,az as Q}from"./index.C__3lhMr.js";import{l as W,R as X,i as Z,r as g,b as aa,d as ea,K as r,L as u,U as oa,V as n,k as t,N as o,u as s,O as l,M as y}from"./vue.C2TeXnf4.js";import{_ as c}from"./BaseInfoItem.vue_vue_type_style_index_0_lang.MpSsZcmr.js";import"./right-arrow-icon.CaFxgYzl.js";const ta={class:"add-home-box hk-flex hk-flex-col container-setPx"},na={class:"add-home-form"},sa=["src"],ia={class:"staff-details-info"},la={key:0,class:"staff-details-info"},ca={class:"staff-details-info"},ra={class:"staff-details-info"},da=o("div",{class:"footer-aux-btmbox"},null,-1),fa={class:"footer-btn-box"},ma=o("div",{class:"staff-details-dialog"},[o("div",{class:"pd-dialog-content"}," 确定注销账号? ")],-1),Ia=W({name:"PersonalInfo",__name:"personalInfo",setup(ga){const{t:d}=F(),P=X(),{id:C,homeId:S}=P.query,{hkMessage:f}=J();H();const B=O(),_=Y(),m=Z("doViewsCache"),p=g(null),{clearStoreAll:w}=Q(),{pushName:v,comeback:ua,replacePath:L}=E(),{pageLoading:M,endPageLoading:b}=V({activeAction:R}),h=g(null),I=g(!0),a=aa({nickname:"",avatar:"",birthday:"",contactInformation:"",joinTime:0}),k=i=>{K().then(e=>{e.code===0?(a.avatar=e.data.avatar,a.nickname=e.data.nickname,a.birthday=e.data.birthday,a.contactInformation=e.data.contactInformation,a.joinTime=e.data.joinTime):f(e.msg)}).finally(()=>{I.value=!1,i&&i()})},T=()=>{v("PersonalInfoEdit",{id:C,homeId:S})},j=()=>{h.value.taggleModal()};async function R(){k(b)}const A=()=>{G().then(async i=>{i.code===0?(f("账号注销成功"),m==null||m(),await _.$reset(),await B.$reset(),sessionStorage.clear(),w(),_.updateUserInfo("homeSimple",[]),p.value.taggleDialog(!1),L("/login")):f(i.msg)})};return ea(()=>{k(b)}),(i,e)=>{const D=r("BtmSingleBtn"),N=r("PreviewImage"),U=r("ConfrimPopAgain"),$=r("MainContainer");return u(),oa($,{exitLoading:!0,pageLoading:s(M)},{header:n(()=>[t(q,{title:"个人资料"})]),default:n(()=>[o("div",ta,[o("div",na,[t(c,{class:"pd-img",label:"照片"},{default:n(()=>[o("img",{class:"bi-info-img",src:s(x)+a.avatar,onClick:j},null,8,sa)]),_:1}),t(c,{label:s(d)("base.nameTxt")},{default:n(()=>[o("div",ia,l(a.nickname),1)]),_:1},8,["label"]),t(c,{label:s(d)("base.telNotxt")},{default:n(()=>[a.contactInformation?(u(),y("div",la,l(a.contactInformation),1)):(u(),y("div",{key:1,class:"staff-details-info to-banding-tel",onClick:e[0]||(e[0]=_a=>s(v)("BindingTel"))},l(I.value?"":"绑定手机"),1))]),_:1},8,["label"]),t(c,{label:s(d)("base.birthdayTxt")},{default:n(()=>[o("div",ca,l(a.birthday),1)]),_:1},8,["label"]),t(c,{label:"注册时间"},{default:n(()=>[o("div",ra,l(s(z)(a.joinTime*1e3).format("YYYY-MM-DD HH:mm")),1)]),_:1})]),da,o("div",fa,[t(D,{disable:!0,class:"personal-info-sbtn",handleTxt:"编辑资料",onOnHandle:T})])]),t(N,{ref_key:"previewImgRef",ref:h,imageList:[s(x)+a.avatar]},null,8,["imageList"]),t(U,{ref_key:"confirmPopRef",ref:p,popClass:"staff-details-dialog-box",customFooter:!0,onOnConfirm:A},{default:n(()=>[ma]),_:1},512)]),_:1},8,["pageLoading"])}}});export{Ia as default};
