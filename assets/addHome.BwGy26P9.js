import{l as ee,R as ae,r as d,b as oe,a as te,d as le,K as m,L as k,U as D,V as r,k as l,u as o,N as n,M as ne,S as O,a6 as N,O as B,D as se}from"./vue.C2TeXnf4.js";import{_ as re}from"./info-icon.D_5ulZjW.js";import{I as ce,c as de,d as ue,j as ie,f as me,t as y,P as pe,u as fe,E as ge,o as ye,a as ve,G as _e,H as he}from"./index.C__3lhMr.js";import{_ as i}from"./BaseInfoItem.vue_vue_type_style_index_0_lang.MpSsZcmr.js";import"./right-arrow-icon.CaFxgYzl.js";const Ie={class:"add-home-box hk-flex hk-flex-col container-setPx"},be={class:"add-home-form"},ke={key:0,class:"personal-deatils-upimg home-upload-img-box"},xe={class:"hk-flex hk-items-center"},Ce=n("div",{class:"wktime-info-desc"},"填写的工作时长为每日正常工作时长，超出正常工作时长的部分为加班时长，如填0则不计算加班时长。",-1),Ve=n("img",{class:"wktime-info-icon",src:re,alt:"",srcset:""},null,-1),Te={class:"hk-flex hk-items-center wktime-info-value"},Re=n("span",null,"小时",-1),He=n("div",{class:"footer-aux-btmbox"},null,-1),Ae={class:"footer-btn-box"},Se=n("div",{class:"short-tips-dialog"},[n("div",{class:"pd-dialog-content"},"所选国家与货币不匹配，请再次确认")],-1),Ue=n("div",{class:"short-tips-dialog"},[n("div",{class:"pd-dialog-content"},"修改货币种类仅修改名称，不会切换汇率")],-1),Be=ee({__name:"addHome",setup(we){const{t:s}=fe(),x=ae(),c=d(x.query.id),C=ce.inApp(),{pageLoading:M,endPageLoading:q}=de({}),v=d(!1),V=d(null),T=d(null),_=d(null),h=d(null),I=d([]),b=d(null),{comeback:F,pushName:E}=ue(),{hkMessage:f}=ve(),R=ie(),$=t=>{let e=t.replace(/[^0-9.,]/g,"");return t.match(/\d+(\.\d{0,1})?/)&&(e=e.match(/\d+(\.\d{0,1})?/)[0]),e=+e>=23?"23":e,e},a=oe({name:"",country:"中国",countryId:1,area:"",address:"",currency:"CNY",currencyId:1,pictrue:"",overTime:10,areaInfo:{}}),H=te(()=>!!a.name&&!!a.country&&!!a.currency),j=t=>{a.areaInfo=t,a.country=t.countryName,a.countryId=t.countryId,a.currency=t.currency,a.currencyId=t.currencyId},A=()=>{V.value.taggleVisible(!0)};let p=null;const G=t=>{if(c.value){p=t,h.value.taggleDialog(!0);return}a.currency=t.currency,a.currencyId=t.currencyId},K=()=>{a.currency=p.currency,a.currencyId=p.currencyId,p=null,h.value.taggleDialog(!1)},Y=()=>{p=null},S=()=>{T.value.taggleVisible(!0)},z=t=>{ge({homeId:+c.value}).then(e=>{e.code===0?(a.name=e.data.nickname,a.country=e.data.country,a.countryId=e.data.countryId,a.area=e.data.area,a.address=e.data.address,a.currency=e.data.currency,a.currencyId=e.data.currencyId,a.pictrue=e.data.avatar,a.overTime=e.data.overTime,I.value=[{url:ye+e.data.avatar,baseUrl:e.data.avatar}],e.data.country,e.data.countryId,e.data.currency,e.data.currencyId):f(e.msg)}).finally(()=>{t&&t()})},J=t=>{const e={nickname:a.name,avatar:t,area:a.area,address:a.address,overTime:a.overTime||"0"};c.value&&(e.homeId=c.value),e.countryId=a.countryId,e.currencyId=a.currencyId,(c.value?_e:he)(e).then(async g=>{g.code===0?(await R.setHomeSimpleLs(),R.setUserIdent(),c.value?f("保存成功"):f("添加新家成功"),x.query.homeId?E("Home"):F()):f(g.msg)}).finally(()=>{v.value=!1})},U=()=>{var e;if(!H.value)return;v.value=!0;const t=(e=b.value)==null?void 0:e.getValues();J(t[0])},Q=()=>{a.areaInfo.currencyId&&a.currencyId!==a.areaInfo.currencyId?_.value.taggleDialog(!0):U()},W=()=>{_.value.taggleDialog(!1)};return le(()=>{c.value&&z(q)}),(t,e)=>{const w=m("UploadImg"),g=m("AppUploadImg"),X=m("BtmSingleBtn"),L=m("AreaSelect"),P=m("ConfrimPopAgain"),Z=m("MainContainer");return k(),D(Z,{exitLoading:!!c.value,pageLoading:o(M)},{header:r(()=>[l(me,{title:c.value?o(s)("base.btn.editHome"):o(s)("base.header.addHome")},null,8,["title"])]),default:r(()=>[n("div",Ie,[n("div",be,[l(i,{class:"pd-img",label:"照片",isHaveRArrow:!0,isRequire:!0},{default:r(()=>[o(C)?O("",!0):(k(),ne("div",ke,[l(w,{isDelete:!1,ref_key:"uploadImgRef",ref:b,fileValues:I.value,maxCount:1},null,8,["fileValues"])])),o(C)?(k(),D(g,{key:1,class:"personal-deatils-upimg home-upload-img-box",ref_key:"uploadImgRef",ref:b,value:I.value},null,8,["value"])):O("",!0)]),_:1}),l(i,{label:o(s)("base.homeNameTxt"),isRequire:!0},{default:r(()=>[l(o(y),{modelValue:a.name,"onUpdate:modelValue":e[0]||(e[0]=u=>a.name=u),placeholder:o(s)("base.pleaseInputTxt")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(i,{label:o(s)("base.countryTxt"),isHaveRArrow:!0,isRequire:!0,onOnHandle:A},{default:r(()=>[n("div",{class:"adh-select-value",onClick:N(A,["stop"])},B(a.country),1)]),_:1},8,["label"]),l(i,{label:o(s)("base.currency"),isHaveRArrow:!0,isRequire:!0,onOnHandle:S},{default:r(()=>[n("div",{class:"adh-select-value",onClick:N(S,["stop"])},B(a.currency),1)]),_:1},8,["label"]),l(i,{label:o(s)("base.areaTxt")},{default:r(()=>[l(o(y),{modelValue:a.area,"onUpdate:modelValue":e[1]||(e[1]=u=>a.area=u),placeholder:o(s)("base.pleaseInputTxt")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(i,{label:o(s)("base.addressTxt")},{default:r(()=>[l(o(y),{modelValue:a.address,"onUpdate:modelValue":e[2]||(e[2]=u=>a.address=u),placeholder:o(s)("base.pleaseInputTxt")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(i,{label:o(s)("base.addressTxt")},{label:r(()=>[n("div",xe,[se(" 工作时长 "),l(o(pe),{class:"wktime-info-pop",theme:"dark",placement:"top-start","close-on-click-action":!1,"close-on-click-outside":!1,"close-on-click-overlay":!1},{reference:r(()=>[Ve]),default:r(()=>[Ce]),_:1})])]),default:r(()=>[n("div",Te,[l(o(y),{modelValue:a.overTime,"onUpdate:modelValue":e[3]||(e[3]=u=>a.overTime=u),formatter:$,placeholder:"0"},null,8,["modelValue"]),Re])]),_:1},8,["label"])]),He,n("div",Ae,[l(X,{loading:v.value,disable:H.value,handleTxt:o(s)("base.btn.save"),onOnHandle:Q},null,8,["loading","disable","handleTxt"])])]),l(L,{ref_key:"areaSelectRef",ref:V,title:o(s)("base.countryTxt"),onOnChange:j},null,8,["title"]),l(L,{ref_key:"coinSelectRef",ref:T,isShowCurrency:!0,title:o(s)("base.currency"),onOnChange:G},null,8,["title"]),l(P,{ref_key:"confirmPopRef",ref:_,popClass:"short-tips-pop",cancelTxt:"确认保存",confirmTxt:"重新选择",customFooter:!0,onOnCancel:U,onOnConfirm:W},{default:r(()=>[Se]),_:1},512),l(P,{ref_key:"mgvalChangeRef",ref:h,popClass:"short-tips-pop",customFooter:!0,onOnCancel:Y,onOnConfirm:K},{default:r(()=>[Ue]),_:1},512)]),_:1},8,["exitLoading","pageLoading"])}}});export{Be as default};
