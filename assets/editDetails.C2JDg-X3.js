import{d as le,l as i,m as se,g as ie,p as ce,o as I,a as R,B as n,x as o,i as s,Q as c,L as V,S as u,f as D,e as de,H as re,_ as ue,j as me,r as m,a6 as H}from"./vue.BCHSKM6y.js";import{I as fe,a3 as pe,y as be,b as ge,c as _e,aA as he,e as ve,aB as Ie,t as w,a6 as ye,g as xe,ai as ke}from"./index.Cjri3_sP.js";import{_ as d}from"./BaseInfoItem.vue_vue_type_style_index_0_lang.DMYgpoJW.js";import{A as Te}from"./index.YYOoEeNT.js";import"./right-arrow-icon.CaFxgYzl.js";const Se={class:"updata-staff-box hk-flex hk-flex-col container-setPx"},Ce={class:"updata-staff-form"},Ae=s("div",{class:"info-no-input"},"管家",-1),Me={class:"info-no-input"},Re={class:"info-no-input"},Ve={class:"info-no-input"},De={class:"form-upload-img-box"},He={class:"form-upload-img-tit"},we=s("span",null,"*",-1),Be={key:0,class:"form-upload-img"},Ne=s("div",{class:"footer-aux-btmbox"},null,-1),Ue={class:"footer-btn-box"},je={class:"staff-edit-dialog"},Le={class:"pd-dialog-content"},Oe=s("p",null,"提示：请勿忘记线下收回备用金",-1),Ee=le({__name:"editDetails",setup(Pe){const{t:l}=ge(),p=i([]),B=ue(),y=fe.inApp(),b=new Date,N=me("endPageLoading"),U=b.getFullYear(),j=b.getMonth(),L=b.getDate(),g=i(!1),x=i(null),k=i(null),O=i(null),P=pe(),T=i(!0),_=i(null),{comeback:Y,goback:$}=_e(),{hkMessage:r}=xe(),{id:h,homeId:q}=B.query,v=i(!1),e=se({nickname:"",avatar:"",homeName:"",birthday:"",contactInformation:"",identifyMsgId:"",duties:"",country:"",joinTime:0,countryId:0,dutiesId:0}),F=ie(()=>!!e.nickname&&!!e.contactInformation&&!!e.country&&T.value),J=a=>{e.country=a.countryName,e.countryId=a.countryId},E=a=>{he({identifyId:+h}).then(t=>{t.code===0?(e.avatar=t.data.avatar,e.nickname=t.data.nickname,e.homeName=t.data.homeName,e.birthday=t.data.birthday,e.contactInformation=t.data.contactInformation,e.identifyMsgId=t.data.identifyMsgId,e.country=t.data.country,e.duties=t.data.duties,e.joinTime=t.data.joinTime,e.countryId=t.data.countryId,e.dutiesId=t.data.dutiesId,p.value=[{url:ve+t.data.avatar,baseUrl:t.data.avatar}]):r(t.msg)}).finally(()=>{a&&a()})},S=i([]),Q=()=>{v.value=!1},z=a=>{e.duties=a.name,e.dutiesId=a.value},C=()=>{x.value.taggleVisible(!0)},A=()=>{k.value.taggleVisible()},G=a=>{e.birthday=`${a[0]}-${a[1]}-${a[2]}`},K=a=>{ke({identifyId:+h,nickname:e.nickname,avatar:a,birthday:e.birthday,contactInformation:e.contactInformation,identifyMsgId:e.identifyMsgId,countryId:e.countryId}).then(t=>{t.code===0?(r("保存成功"),Y()):r(t.msg)}).catch(t=>{r(t)}).finally(()=>{g.value=!1})},W=()=>{var t;g.value=!0;const a=(t=_.value)==null?void 0:t.getValues();K(a[0])},X=()=>{Ie({identifyId:+h,homeId:+q}).then(a=>{a.code===0?(r("离职成功"),$(-2)):r(a.msg)}).catch(a=>{r(a)})},M=a=>{T.value=a};return ce(async()=>{E(N);const a=await P.getJob;S.value=a.map(t=>({name:t.text,value:t.value}))}),(a,t)=>{const Z=m("UploadImg"),ee=m("AppUploadImg"),te=m("BtmSingleBtn"),ae=m("ConfrimPopAgain"),oe=m("AreaSelect"),ne=m("DateSelect");return I(),R(re,null,[n(be,{title:o(l)("base.staffInfoTxt",{do:o(l)("base.editTxt")})},null,8,["title"]),s("div",Se,[s("div",Ce,[n(d,{label:o(l)("base.nameTxt"),isRequire:!0},{default:c(()=>[n(o(w),{modelValue:e.nickname,"onUpdate:modelValue":t[0]||(t[0]=f=>e.nickname=f),placeholder:o(l)("base.pleaseInputTxt")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),n(d,{label:o(l)("base.jopTxt")},{default:c(()=>[Ae]),_:1},8,["label"]),n(d,{label:o(l)("base.belongHomeTxt")},{default:c(()=>[s("div",Me,u(e.homeName),1)]),_:1},8,["label"]),n(d,{label:o(l)("base.nationTxt"),isHaveRArrow:!0,isRequire:!0,onOnHandle:C},{default:c(()=>[s("div",{onClick:H(C,["stop"])},u(e.country),1)]),_:1},8,["label"]),n(d,{label:o(l)("base.idCard")},{default:c(()=>[n(o(w),{modelValue:e.identifyMsgId,"onUpdate:modelValue":t[1]||(t[1]=f=>e.identifyMsgId=f),placeholder:o(l)("base.pleaseInputTxt")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),n(d,{label:o(l)("base.telNotxt")},{default:c(()=>[s("div",Re,u(e.contactInformation),1)]),_:1},8,["label"]),n(d,{label:o(l)("base.birthdayTxt"),isHaveRArrow:!0,isRequire:!0,onOnHandle:A},{default:c(()=>[s("div",{onClick:H(A,["stop"])},u(e.birthday),1)]),_:1},8,["label"]),n(d,{label:o(l)("base.entryTime")},{default:c(()=>[s("div",Ve,u(o(ye)(e.joinTime*1e3).format("YYYY-MM-DD HH:mm")),1)]),_:1},8,["label"]),s("div",De,[s("div",He,[V(u(o(l)("base.pictrueTxt")),1),we]),o(y)?D("",!0):(I(),R("div",Be,[n(Z,{ref_key:"uploadImgRef",ref:_,fileValues:p.value,maxCount:1,onOnChangeIsLength:M},null,8,["fileValues"])])),o(y)?(I(),de(ee,{key:1,ref_key:"uploadImgRef",ref:_,value:p.value,onOnChangeImg:M},null,8,["value"])):D("",!0)])]),Ne,s("div",Ue,[n(te,{loading:g.value,disable:F.value,handleTxt:o(l)("base.btn.save"),onOnHandle:W},null,8,["loading","disable","handleTxt"])])]),n(o(Te),{class:"hk-action-sheet",show:v.value,"onUpdate:show":t[2]||(t[2]=f=>v.value=f),actions:S.value,"cancel-text":"取消","close-on-click-action":"",onCancel:Q,onSelect:z},null,8,["show","actions"]),n(ae,{ref_key:"confirmPopRef",ref:O,popClass:"staff-edit-dialog-box",customFooter:!0,onOnConfirm:X},{default:c(()=>[s("div",je,[s("div",Le,[V(u(o(l)("base.confirmDelStaff"))+" ",1),Oe])])]),_:1},512),n(oe,{ref_key:"areaSelectRef",ref:x,title:o(l)("base.countryTxt"),onOnChange:J},null,8,["title"]),n(ne,{ref_key:"dateSelectRef",ref:k,maxLimit:new Date(o(U),o(j),o(L)),onOnChangeVal:G},null,8,["maxLimit"])],64)}}});export{Ee as default};
