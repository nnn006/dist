import{l as le,r as c,R as se,i as ie,b as ce,a as de,d as re,K as u,L as I,U as A,V as i,k as o,u as n,N as s,M as ue,S as V,O as m,a6 as w,D as me}from"./vue.C2TeXnf4.js";import{I as fe,q as pe,d as be,s as ge,f as _e,t as H,n as he,u as ve,p as Ie,o as ye,r as xe,a as ke,v as Te}from"./index.C__3lhMr.js";import{_ as d}from"./BaseInfoItem.vue_vue_type_style_index_0_lang.MpSsZcmr.js";import{A as Ce}from"./index.DcHIdklB.js";import"./right-arrow-icon.CaFxgYzl.js";const Me={class:"updata-staff-box hk-flex hk-flex-col container-setPx"},Re={class:"updata-staff-form"},Se={key:0,class:"personal-deatils-upimg"},De=s("div",{class:"info-no-input"},"管家",-1),Ae={class:"info-no-input"},Ve={class:"info-no-input"},we={class:"info-no-input"},He=s("div",{class:"footer-aux-btmbox"},null,-1),Ne={class:"footer-btn-box"},Ue={class:"staff-edit-dialog"},Oe={class:"pd-dialog-content"},Le=s("p",null,"提示：请勿忘记线下收回备用金",-1),Fe=le({__name:"editDetails",setup(je){const{t:l}=ve(),p=c([]),N=se(),y=fe.inApp(),b=new Date,U=ie("endPageLoading"),O=b.getFullYear(),L=b.getMonth(),j=b.getDate(),g=c(!1),x=c(null),k=c(null),B=c(null);pe();const T=c(!0),_=c(null),{comeback:P,goback:q}=be(),{hkMessage:r}=ke(),{getJobType:Y}=ge(),{id:h,homeId:C}=N.query,v=c(!1),e=ce({nickname:"",avatar:"",homeName:"",birthday:"",contactInformation:"",identifyMsgId:"",duties:"",country:"",joinTime:0,countryId:0,dutiesId:0}),$=de(()=>!!e.nickname&&!!e.contactInformation&&!!e.country&&T.value),F=t=>{e.country=t.countryName,e.countryId=t.countryId},J=t=>{Ie({identifyId:+h}).then(a=>{a.code===0?(e.avatar=a.data.avatar,e.nickname=a.data.nickname,e.homeName=a.data.homeName,e.birthday=a.data.birthday,e.contactInformation=a.data.contactInformation,e.identifyMsgId=a.data.identifyMsgId,e.country=a.data.country,e.duties=a.data.duties,e.joinTime=a.data.joinTime,e.countryId=a.data.countryId,e.dutiesId=a.data.dutiesId,p.value=[{url:ye+a.data.avatar,baseUrl:a.data.avatar}]):r(a.msg)}).finally(()=>{t&&t()})},M=c([]),E=()=>{v.value=!1},G=t=>{e.duties=t.name,e.dutiesId=t.value},R=()=>{x.value.taggleVisible(!0)},S=()=>{k.value.taggleVisible()},K=t=>{e.birthday=`${t[0]}-${t[1]}-${t[2]}`},z=t=>{Te({identifyId:+h,nickname:e.nickname,avatar:t,birthday:e.birthday,contactInformation:e.contactInformation,identifyMsgId:e.identifyMsgId,countryId:e.countryId}).then(a=>{a.code===0?(r("保存成功"),P()):r(a.msg)}).catch(a=>{r(a)}).finally(()=>{g.value=!1})},Q=()=>{var a;g.value=!0;const t=(a=_.value)==null?void 0:a.getValues();z(t[0])},W=()=>{xe({identifyId:+h,homeId:+C}).then(t=>{t.code===0?(r("离职成功"),q(-2)):r(t.msg)}).catch(t=>{r(t)})},D=t=>{T.value=t};return re(async()=>{J(U);const t=await Y(C);M.value=t.map(a=>({name:a.text,value:a.value}))}),(t,a)=>{const X=u("UploadImg"),Z=u("AppUploadImg"),ee=u("BtmSingleBtn"),ae=u("ConfrimPopAgain"),te=u("AreaSelect"),ne=u("DateSelect"),oe=u("MainContainer");return I(),A(oe,null,{header:i(()=>[o(_e,{title:n(l)("base.staffInfoTxt",{do:n(l)("base.editTxt")})},null,8,["title"])]),default:i(()=>[s("div",Me,[s("div",Re,[o(d,{class:"pd-img",label:"照片",isHaveRArrow:!0,isRequire:!0},{default:i(()=>[n(y)?V("",!0):(I(),ue("div",Se,[o(X,{isDelete:!1,ref_key:"uploadImgRef",ref:_,fileValues:p.value,maxCount:1,onOnChangeIsLength:D},null,8,["fileValues"])])),n(y)?(I(),A(Z,{key:1,class:"personal-deatils-upimg",ref_key:"uploadImgRef",ref:_,value:p.value,onOnChangeImg:D},null,8,["value"])):V("",!0)]),_:1}),o(d,{label:n(l)("base.nameTxt"),isRequire:!0},{default:i(()=>[o(n(H),{modelValue:e.nickname,"onUpdate:modelValue":a[0]||(a[0]=f=>e.nickname=f),placeholder:n(l)("base.pleaseInputTxt")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(d,{label:n(l)("base.jopTxt")},{default:i(()=>[De]),_:1},8,["label"]),o(d,{label:n(l)("base.belongHomeTxt")},{default:i(()=>[s("div",Ae,m(e.homeName),1)]),_:1},8,["label"]),o(d,{label:n(l)("base.nationTxt"),isHaveRArrow:!0,isRequire:!0,onOnHandle:R},{default:i(()=>[s("div",{onClick:w(R,["stop"])},m(e.country),1)]),_:1},8,["label"]),o(d,{label:n(l)("base.idCard")},{default:i(()=>[o(n(H),{modelValue:e.identifyMsgId,"onUpdate:modelValue":a[1]||(a[1]=f=>e.identifyMsgId=f),placeholder:n(l)("base.pleaseInputTxt")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(d,{label:n(l)("base.telNotxt")},{default:i(()=>[s("div",Ve,m(e.contactInformation),1)]),_:1},8,["label"]),o(d,{label:n(l)("base.birthdayTxt"),isHaveRArrow:!0,isRequire:!0,onOnHandle:S},{default:i(()=>[s("div",{onClick:w(S,["stop"])},m(e.birthday),1)]),_:1},8,["label"]),o(d,{label:n(l)("base.entryTime")},{default:i(()=>[s("div",we,m(n(he)(e.joinTime*1e3).format("YYYY-MM-DD HH:mm")),1)]),_:1},8,["label"])]),He,s("div",Ne,[o(ee,{loading:g.value,disable:$.value,handleTxt:n(l)("base.btn.save"),onOnHandle:Q},null,8,["loading","disable","handleTxt"])])]),o(n(Ce),{class:"hk-action-sheet",show:v.value,"onUpdate:show":a[2]||(a[2]=f=>v.value=f),actions:M.value,"cancel-text":"取消","close-on-click-action":"",onCancel:E,onSelect:G},null,8,["show","actions"]),o(ae,{ref_key:"confirmPopRef",ref:B,popClass:"staff-edit-dialog-box",customFooter:!0,onOnConfirm:W},{default:i(()=>[s("div",Ue,[s("div",Oe,[me(m(n(l)("base.confirmDelStaff"))+" ",1),Le])])]),_:1},512),o(te,{ref_key:"areaSelectRef",ref:x,title:n(l)("base.countryTxt"),onOnChange:F},null,8,["title"]),o(ne,{ref_key:"dateSelectRef",ref:k,maxLimit:new Date(n(O),n(L),n(j)),onOnChangeVal:K},null,8,["maxLimit"])]),_:1})}}});export{Fe as default};
