import{d as M,Q as R,u as C,ad as D,a as P,b}from"./index.C__3lhMr.js";import{_ as I}from"./NewsItem.vue_vue_type_style_index_0_lang.C3OnuWsN.js";import{l as O,r as g,i as A,b as V,a as z,d as B,K as r,L as H,U as j,V as c,N as o,k as d,u as J}from"./vue.C2TeXnf4.js";const U={class:"news-main-content"},$={class:"screen-box hk-flex hk-w-full"},K={class:"screen-item"},Q={class:"news-main-content hk-pt-104"},W={class:"news-main-box"},q=["src"],Z=O({__name:"hkDealNews",setup(E){const{t:i}=C(),u=g(null),{hkMessage:_}=P(),{pushName:h}=M(),{showLoading:y,closeLoading:w}=b(),p=g([]),v=A("endPageLoading"),a=V({page:1,pageSize:10,total:0,curTime:0,allPayMoney:0,currency:""});z(()=>[{text:i("base.screen.news.all"),value:0},{text:i("base.screen.news.pay"),value:1},{text:i("base.screen.news.end"),value:3}]);const T=g({text:i("base.screen.news.all"),value:0}),l=s=>{const f={page:a.page,pageSize:a.pageSize,selectTime:Math.floor(a.curTime/1e3),selectNotifyType:T.value.value};D(f).then(t=>{if(t.code===0){const n=t.data.list.map(e=>({id:e.applicationId,title:e.title,value:e.typ===3?e.useCarTime:e.amount,type:e.typ===1?"price":e.typ===3?"time":"text",currencyType:e.currency,pic:e.identifyAvatar,applyState:e.status,active:!1,homeName:e.homeName,identifyName:e.identifyName,applicationTime:e.applicationTime,status:e.status,endTime:e.endTime,startTime:e.startTime,typ:e.typ}));f.page===1?p.value=n:p.value.push(...n),a.total=t.data.total,a.allPayMoney=t.data.allPayMoney,a.currency=t.data.currency}else _(t.msg)}).finally(()=>{var t,n;(t=u.value)==null||t.taggleRefreshState("isLoading",!1),(n=u.value)==null||n.taggleRefreshState("loading",!1),s&&s()})},S=s=>{window.sessionStorage.setItem("hkDealNews",JSON.stringify({time:a.curTime})),h("PayStfDetails",{id:s.id})},N=()=>{a.page++,l()},k=()=>{a.page=1,l()},L=s=>{a.curTime=new Date(s).getTime(),a.page=1,y(),l(w)};return B(()=>{const s=window.sessionStorage.getItem("hkDealNews");s&&(a.curTime=JSON.parse(s).time,window.sessionStorage.removeItem("hkDealNews")),l(v)}),(s,f)=>{const t=r("MonthSelect"),n=r("SecondHeader"),e=r("DownRefresh"),x=r("MainContainer");return H(),j(x,null,{headerScreen:c(()=>[o("div",U,[d(n,null,{default:c(()=>[o("div",$,[o("div",K,[d(t,{isAll:a.curTime===0,value:a.curTime,onOnTimeChange:L},null,8,["isAll","value"])])])]),_:1})])]),default:c(()=>[o("div",Q,[o("div",W,[d(e,{ref_key:"downRefreshRef",ref:u,dataList:p.value,pagination:a,onOnRefresh:k,onOnLoad:N},{default:c(({data:m})=>[d(I,{data:m,onClick:F=>S(m)},{examineState:c(()=>[o("img",{class:"msg-state-img",src:J(R)(m.status===3?"stfReject":"stfWaitUpd"),alt:"",srcset:""},null,8,q)]),_:2},1032,["data","onClick"])]),_:1},8,["dataList","pagination"])])])]),_:1})}}});export{Z as default};
