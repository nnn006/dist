import{l as H,r as w,b as V,a as A,d as J,L as q,U as E,V as l,u as f,J as $,R as j,K as m,N as a,k as i,O as C}from"./vue.C2TeXnf4.js";import{u as K,g as U,e as F,a as G,b as Q}from"./index.C__3lhMr.js";import{_ as W}from"./NewsItem.vue_vue_type_style_index_0_lang.C3OnuWsN.js";import{u as X}from"./useConfigBaseInfo.CxjUSntV.js";const Y={class:"data-review-box"},Z={class:"screen-box hk-flex hk-w-full"},ee={class:"screen-item"},se={class:"hk-flex hk-items-center"},te={class:"news-select-value"},ae={class:"screen-item"},oe={class:"hk-flex hk-items-center"},ne={class:"news-select-value"},ie={class:"screen-item"},ce={class:"data-review-box news-main-box hk-pt-104"},le=["src"],fe=H({__name:"index",setup(re){const{t:T}=K(),{hkMessage:x}=G(),k=$();j().query;const h=w(null),_=w([]),s=V({page:1,pageSize:10,total:0,curTime:0,allPayMoney:0,currency:""}),L=A(()=>[{text:"全部消息",value:0},{text:T("base.screen.msgClass.pay"),value:1},{text:T("base.screen.msgClass.car"),value:3}]),r=w({text:"全部消息",value:0}),{showLoading:v,closeLoading:y}=Q(),R=async t=>{d.home=t,s.page=1,v(),await u(),y()},b=async t=>{r.value=t,s.page=1,v(),await u(),y()},u=()=>new Promise(t=>{var g;const n={page:s.page,pageSize:s.pageSize,homeId:d.home.value,selectTime:Math.floor(s.curTime/1e3),selectTimeTyp:2,typ:((g=r.value)==null?void 0:g.value)||0};F(n).then(o=>{if(o.code===0){const c=o.data.list.map(e=>({id:e.applicationId,title:e.title,value:e.typ===3?e.useCarTime:e.amount,type:e.typ===1?"price":e.typ===3?"time":"text",currencyType:e.currency,pic:e.identifyAvatar,applyState:e.status,active:!1,homeName:e.homeName,identifyName:e.identifyName,applicationTime:e.applicationTime,endTime:e.endTime,startTime:e.startTime,status:e.status,useCarTime:e.useCarTime,typ:e.typ}));n.page===1?_.value=c:_.value.push(...c),s.total=o.data.total}else x(o.msg)}).finally(()=>{var o,c;(o=h.value)==null||o.taggleRefreshState("isLoading",!1),(c=h.value)==null||c.taggleRefreshState("loading",!1),t(!0)})}),D=()=>{s.page=1,u()},{homeSelectData:M,screenVal:d,pageLoading:O}=X({loadList:async()=>{s.page=1,await u()}}),I=t=>{window.sessionStorage.setItem("statisticDetails",JSON.stringify({home:d.home,time:s.curTime,msg:r.value})),k.push({name:"PayDetails",query:{id:t.id}})},N=()=>{s.page++,u()},P=async t=>{s.curTime=new Date(t).getTime(),s.page=1,v(),await u(),y()};return J(()=>{const t=window.sessionStorage.getItem("statisticDetails");if(t){const n=JSON.parse(t);n.time&&(s.curTime=n.time),n.msg&&(r.value=n.msg)}}),(t,n)=>{const g=m("SvgIcon"),o=m("HkPopover"),c=m("MonthSelect"),e=m("SecondHeader"),z=m("DownRefresh"),B=m("MainContainer");return q(),E(B,{exitLoading:!0,pageLoading:f(O)},{headerScreen:l(()=>[a("div",Y,[i(e,null,{default:l(()=>{var p;return[a("div",Z,[a("div",ee,[i(o,{options:f(M),value:f(d).home.value,pannelClass:"news-minw-168",placement:"bottom-start",offset:[0,18],isSelectState:!0,onOnChange:R},{taggleEle:l(()=>[a("div",se,[a("span",te,C(f(d).home.text),1),i(g,{iconClass:"down-select-svg",size:"9",color:"#ffffff"})])]),_:1},8,["options","value"])]),a("div",ae,[i(o,{options:L.value,value:(p=r.value)==null?void 0:p.value,pannelClass:"news-minw-168",placement:"bottom",offset:[0,18],onOnChange:b,isSelectState:!0,isSplitBorder:[0]},{taggleEle:l(()=>{var S;return[a("div",oe,[a("span",ne,C(((S=r.value)==null?void 0:S.text)||"消息分类"),1),i(g,{iconClass:"down-select-svg",size:"9",color:"#ffffff"})])]}),_:1},8,["options","value"])]),a("div",ie,[i(c,{isAll:s.curTime===0,value:s.curTime,onOnTimeChange:P},null,8,["isAll","value"])])])]}),_:1})])]),default:l(()=>[a("div",ce,[i(z,{ref_key:"downRefreshRef",ref:h,dataList:_.value,pagination:s,onOnRefresh:D,onOnLoad:N},{default:l(({data:p})=>[i(W,{data:p,onClick:S=>I(p)},{examineState:l(()=>[a("img",{class:"msg-state-img",src:f(U)(p.status),alt:"",srcset:""},null,8,le)]),_:2},1032,["data","onClick"])]),_:1},8,["dataList","pagination"])])]),_:1},8,["pageLoading"])}}});export{fe as default};
