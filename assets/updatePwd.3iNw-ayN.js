import{l as T,R as B,a as m,b,K as g,L as I,U as N,V as d,k as i,N as c,u as s,D as $}from"./vue.C2TeXnf4.js";import{j as U,d as F,f as R,t as f,a0 as h,a1 as E,M,u as A,a2 as j,$ as _}from"./index.C__3lhMr.js";const q={class:"set-pwd-box hk-pt-52"},z={class:"set-pwd-form"},H=["src"],K=c("div",{class:"form-item-auxbox"},null,-1),L=["src"],W=c("div",{class:"form-item-auxbox"},null,-1),Z=["src"],Y=T({__name:"updatePwd",setup(G){const V=B(),v=U(),{pushName:J,replacePath:x}=F();V.query;const{t:l}=A(),C=m(()=>l("base.setNewPwdTxt")),e=b({oldPwd:"",password:"",oncePwd:""}),r=b({oldPwdError:!1,passwordError:!1,oncePwdError:!1}),O=m(()=>e.oldPwd&&e.password&&e.oncePwd===e.password&&!r.passwordError&&!r.oncePwdError&&!r.oldPwdError),n=b({isPwdShow:!1,isOncePwdShow:!1,isOldPwd:!1}),p=m(()=>({oldPwdErr:["请输入旧密码"],pwdErr:[l("base.setPwdErrFir"),l("base.setPwdErrSec")],onceOwdErr:[l("base.setPwdErrTir")]})),y=()=>{const a=/.{8,16}/,o=/[a-zA-Z]/.test(e.password),w=/[0-9]/.test(e.password),P=/[\W_]/.test(e.password),t=(o?1:0)+(w?1:0)+(P?1:0);a.test(e.password)&&t>=2?r.passwordError=!1:r.passwordError=!0},S=()=>{e.oldPwd!==""?r.oldPwdError=!1:r.oldPwdError=!0},k=()=>{e.oncePwd!==""&&e.oncePwd===e.password?r.oncePwdError=!1:r.oncePwdError=!0},u=a=>{n[a]=!n[a]},D=()=>{j({oldPassword:e.oldPwd,newPassword:e.password}).then(async a=>{a.code===0?(_({message:"修改密码成功，请重新登录"}),await v.$reset(),x("/login")):_({message:a.msg,position:"top"})}).catch(a=>{_({message:a,position:"top"})})};return(a,o)=>{const w=g("FormItemPop"),P=g("MainContainer");return I(),N(P,null,{header:d(()=>[i(R,{title:C.value},null,8,["title"])]),default:d(()=>[c("div",q,[c("div",z,[i(w,{label:"旧密码",popVisible:r.oldPwdError,errorData:p.value.oldPwdErr},{default:d(()=>[i(s(f),{modelValue:e.oldPwd,"onUpdate:modelValue":o[1]||(o[1]=t=>e.oldPwd=t),type:n.isOldPwd?"text":"password",placeholder:s(l)("base.setPwdPld"),clearable:"","clear-icon":"cross",onBlur:S},{"right-icon":d(()=>[c("img",{class:"pwd-taggle-icon",src:n.isOldPwd?s(h):s(E),onClick:o[0]||(o[0]=t=>u("isOldPwd")),alt:""},null,8,H)]),_:1},8,["modelValue","type","placeholder"])]),_:1},8,["popVisible","errorData"]),K,i(w,{label:s(l)("base.inputPwdTxt"),popVisible:r.passwordError,errorData:p.value.pwdErr},{default:d(()=>[i(s(f),{modelValue:e.password,"onUpdate:modelValue":o[3]||(o[3]=t=>e.password=t),type:n.isPwdShow?"text":"password",placeholder:s(l)("base.setPwdPld"),clearable:"","clear-icon":"cross",onBlur:y},{"right-icon":d(()=>[c("img",{class:"pwd-taggle-icon",src:n.isPwdShow?s(h):s(E),onClick:o[2]||(o[2]=t=>u("isPwdShow")),alt:""},null,8,L)]),_:1},8,["modelValue","type","placeholder"])]),_:1},8,["label","popVisible","errorData"]),W,i(w,{label:s(l)("base.confirmPwdTxt"),popVisible:r.oncePwdError,errorData:p.value.onceOwdErr},{default:d(()=>[i(s(f),{modelValue:e.oncePwd,"onUpdate:modelValue":o[5]||(o[5]=t=>e.oncePwd=t),type:n.isOncePwdShow?"text":"password",placeholder:s(l)("base.setPwdOncePld"),clearable:"","clear-icon":"cross",onBlur:k},{"right-icon":d(()=>[c("img",{class:"pwd-taggle-icon",src:n.isOncePwdShow?s(h):s(E),onClick:o[4]||(o[4]=t=>u("isOncePwdShow")),alt:""},null,8,Z)]),_:1},8,["modelValue","type","placeholder"])]),_:1},8,["label","popVisible","errorData"])]),i(s(M),{class:"set-step-btn",disabled:!O.value,type:"primary",onClick:D},{default:d(()=>[$("保存")]),_:1},8,["disabled"])])]),_:1})}}});export{Y as default};
