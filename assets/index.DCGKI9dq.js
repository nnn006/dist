import{d as q,q as z,j as G,c as K,f as Q,aB as W,u as X,aE as Y,aF as Z,aG as ee,a as ae,b as se,aH as oe,aI as te}from"./index.C__3lhMr.js";import{_ as ne}from"./manageItem.vue_vue_type_style_index_0_lang.CROEXGMz.js";import{l as le,r as c,d as ie,K as u,L as v,U as M,V as d,k as r,u as I,N as o,O as D,M as N,Q as ce,F as re,S as ue,D as O,n as de}from"./vue.C2TeXnf4.js";const me={class:"staff-manage-box"},ge={class:"screen-box hk-flex hk-w-full"},pe={class:"screen-item"},ve={class:"hk-flex hk-items-center"},fe={class:"sm-select-value"},_e=o("img",{class:"drap-icon",src:te,alt:""},null,-1),he={class:"tips-details-dialog"},Se={class:"tips-dialog-content"},be=o("br",null,null,-1),xe=le({__name:"index",setup(ke){const{t:w}=X(),f=c(null),{pushName:C}=q(),{hkMessage:m}=ae(),j=z(),L=G(),_=c(!1),t=c([]),p=c(null),x=c(null),y=c([{text:w("base.screen.home.all"),value:0}]),{pageLoading:J,endPageLoading:A}=K({}),{showLoading:H,closeLoading:B}=se(),s=c({}),V=e=>{s.value=e,H(),h(B)},R=e=>{var a;p.value=e,(a=f.value)==null||a.taggleDialog(!0)},P=()=>{p.value=null},E=()=>{Y({id:p.value.value}).then(e=>{var a;e.code===0?((a=f.value)==null||a.taggleDialog(!1),m("删除成功"),h(),P(),j.setJob(s.value.value)):m(e.msg)}).catch(e=>{m(e)})},F=e=>{var a;C("JobAdd",{title:e.label,id:e.value,homeId:s.value.value,permission:(a=e.permission)==null?void 0:a[1]}),window.sessionStorage.setItem("jobManage",JSON.stringify(s.value))},T=()=>{C("JobAdd",{homeId:s.value.value}),window.sessionStorage.setItem("jobManage",JSON.stringify(s.value))},h=e=>{_.value=!0,Z({homeId:s.value.value}).then(a=>{if(a.code===0){const n=a.data.list.map(l=>({label:l.title,value:l.id,permission:l.permission}));t.value=n,e&&e()}else m(a.msg)}).finally(()=>{_.value=!1})},U=(e,a,n)=>{oe({tranId:t.value[n].value,index:a+1}).then(l=>{if(l.code===0){const g=JSON.parse(JSON.stringify(t.value)),S=g.splice(n,1)[0],b=g.slice(0,n),k=g.slice(n),i=[...b,...k];i.splice(a,0,S),t.value=i}else m(l.msg)})};async function $(){await L.setHomeSimpleLs();const e=await L.homeSimple;y.value=e,s.value=e[0];const a=window.sessionStorage.getItem("jobManage");a&&(s.value=JSON.parse(a),window.sessionStorage.removeItem("jobManage"))}return ie(async()=>{await $(),h(()=>{ee(x.value,t.value,{handle:".drap-icon",onUpdate:e=>{U(t.value,e.newIndex,e.oldIndex),de(()=>{})}}),A()})}),(e,a)=>{const n=u("SvgIcon"),l=u("HkPopover"),g=u("SecondHeader"),S=u("hk-empty"),b=u("ConfrimPopAgain"),k=u("MainContainer");return v(),M(k,{exitLoading:!0,pageLoading:I(J)},{header:d(()=>[r(Q,{title:I(w)("base.header.posManage")},null,8,["title"]),o("div",me,[r(g,{headerBtmW:!0},{default:d(()=>[o("div",ge,[o("div",pe,[r(l,{options:y.value,value:s.value.value,pannelClass:"saf-manage-minw-168",placement:"bottom-start",offset:[0,18],isSplitBorder:[],isSelectState:!0,onOnChange:V},{taggleEle:d(()=>[o("div",ve,[o("span",fe,D(s.value.text),1),r(n,{iconClass:"down-select-svg",size:"9",color:"#ffffff"})])]),_:1},8,["options","value"])])])]),_:1})])]),default:d(()=>[o("div",{ref_key:"jobManageItemRef",ref:x,class:"job-manage-box hk-pt-104 container-setPx"},[(v(!0),N(re,null,ce(t.value,i=>(v(),N("div",{class:"job-manage-item",key:i.value},[r(ne,{type:2,data:i,onOnClose:R,onOnDetails:F},{default:d(()=>[_e]),_:2},1032,["data"])]))),128))],512),r(W,{onClick:T}),!t.value.length&&!_.value?(v(),M(S,{key:0})):ue("",!0),r(b,{ref_key:"confirmPopRef",ref:f,popClass:"tips-dialog-box",onOnCancel:P,onOnConfirm:E,customFooter:!0},{default:d(()=>{var i;return[o("div",he,[o("div",Se,[O("确定删除“"+D((i=p.value)==null?void 0:i.label)+"”",1),be,O("职位吗？")])])]}),_:1},512)]),_:1},8,["pageLoading"])}}});export{xe as default};
