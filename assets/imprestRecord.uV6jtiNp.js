import{d as C,j as k,f as N,u as x,a as D,b as M}from"./index.C__3lhMr.js";import{l as O,J as b,r as g,i as B,b as P,d as j,K as d,L as z,U as H,V as i,k as c,N as l}from"./vue.C2TeXnf4.js";import{_ as J}from"./NewsItem.vue_vue_type_style_index_0_lang.C3OnuWsN.js";import{b as V}from"./index.DNWpiEF6.js";const $={class:"imp-main-content"},A={class:"screen-box hk-flex hk-w-full"},U={class:"screen-item"},K={class:"imp-main-content hk-pt-104"},q={class:"imp-main-box"},Y=O({__name:"imprestRecord",setup(E){x(),b();const{hkMessage:_}=D(),{pushName:h}=C(),m=g(null),v=B("endPageLoading"),f=g([]),u=k(),e=P({page:1,pageSize:10,total:0,curTime:new Date().getTime()}),{showLoading:y,closeLoading:S}=M(),T=s=>{window.sessionStorage.setItem("stfImprestRecord",JSON.stringify({time:e.curTime})),h("NewsDetails",{id:s.id,tp:s.typ,pgTp:1})},r=s=>{const n={page:e.page,pageSize:e.pageSize,homeId:u.userInfo.homeId,selectTime:Math.floor(e.curTime/1e3),selectTimeTyp:2,identifyId:u.userInfo.identifyId,expenseTypeId:0};V(n).then(a=>{if(a.code===0){const o=a.data.list.map(t=>({id:t.id,title:t.title,value:t.amount,type:"price",currencyType:t.currency,pic:t.identifyAvatar,applyState:t.status,active:!1,homeName:t.homeName,identifyName:t.identifyName,applicationTime:t.applicationTime,typ:t.typ}));n.page===1?f.value=o:f.value.push(...o),e.total=a.data.total}else _(a.msg)}).finally(()=>{var a,o;(a=m.value)==null||a.taggleRefreshState("isLoading",!1),(o=m.value)==null||o.taggleRefreshState("loading",!1),s&&s()})},w=()=>{e.page++,r()},I=()=>{e.page=1,r()},R=s=>{e.curTime=new Date(s).getTime(),e.page=1,y(),r(S)};return j(()=>{const s=window.sessionStorage.getItem("stfImprestRecord");if(s){const n=JSON.parse(s);n.time&&(e.curTime=n.time)}r(v)}),(s,n)=>{const a=d("MonthSelect"),o=d("SecondHeader"),t=d("DownRefresh"),L=d("MainContainer");return z(),H(L,null,{header:i(()=>[c(N,{title:"备用金记录"})]),headerScreen:i(()=>[l("div",$,[c(o,null,{default:i(()=>[l("div",A,[l("div",U,[c(a,{onOnTimeChange:R,value:e.curTime},null,8,["value"])])])]),_:1})])]),default:i(()=>[l("div",K,[l("div",q,[c(t,{ref_key:"downRefreshRef",ref:m,dataList:f.value,pagination:e,onOnRefresh:I,onOnLoad:w},{default:i(({data:p})=>[c(J,{exitBaseInfo:!1,data:p,valColorClass:p.typ===7||p.typ===6?["val-color-yellow"]:[],onClick:F=>T(p)},null,8,["data","valColorClass","onClick"])]),_:1},8,["dataList","pagination"])])])]),_:1})}}});export{Y as default};
