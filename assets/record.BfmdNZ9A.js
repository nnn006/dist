import{u as B,b as H,c as z,g as $}from"./index.Cjri3_sP.js";import{_ as J}from"./TabHeader.vue_vue_type_style_index_0_lang.CUFJY219.js";import{d as j,l as m,m as A,p as q,o as E,e as Q,Q as g,x as c,_ as U,r as p,B as n,i as l,S as F}from"./vue.BCHSKM6y.js";import{_ as G}from"./StatisticTotal.vue_vue_type_style_index_0_lang.BmZUdypW.js";import{_ as K}from"./NewsItem.vue_vue_type_style_index_0_lang.CsWKk6Rr.js";import{s as W}from"./index.XGvY1KZZ.js";import{u as X}from"./useConfigBaseInfo.D5J8WFky.js";const Y={class:"stic-details-box"},Z={class:"screen-box hk-flex hk-jbetween hk-w-full"},ee={class:"screen-item"},te={class:"screen-item"},ae={class:"head-select-value"},oe={class:"stic-details-list"},fe=j({__name:"record",setup(se){H();const{pushName:T}=z(),{hkMessage:w}=$(),b=U();m(b.query.pageTp);const v=B(),_=m([]),h=m(null),y=m(null),e=A({page:1,pageSize:10,total:0,curTime:new Date().getTime(),allPayMoney:0,currency:""}),k=(t,o)=>{d[o]=t,e.page=1,u()},u=()=>new Promise(t=>{const o={page:e.page,pageSize:e.pageSize,homeId:v.userInfo.homeId,selectTime:Math.floor(e.curTime/1e3),selectTimeTyp:r.value,identifyId:v.userInfo.identifyId,expenseTypeId:d.type.value};W(o).then(s=>{if(s.code===0){const i=s.data.list.map(a=>({id:a.id,title:a.title,value:a.payMoney,type:"price",currencyType:a.currency,pic:a.identifyAvatar,applyState:a.status,active:!1,homeName:a.homeName,identifyName:a.identifyName,applicationTime:a.applicationTime,status:a.status}));e.page===1?_.value=i:_.value.push(...i),e.total=s.data.total,e.allPayMoney=s.data.allPayMoney,e.currency=s.data.currency}else w(s.msg)}).finally(()=>{var s,i;(s=y.value)==null||s.taggleRefreshState("isLoading",!1),(i=y.value)==null||i.taggleRefreshState("loading",!1),t(!0)})}),S=()=>{e.page=1,u()},{hTabData:C,feeOption:P,screenVal:d,curValue:r,pageLoading:R}=X({loadList:async()=>{e.page=1,await u()}}),D=t=>{window.sessionStorage.setItem("statisticDetails",JSON.stringify({fee:d.type,time:e.curTime,tabVal:r.value})),T("StfRecordDetails",{id:t.id})},I=t=>{r.value=t,S()},M=()=>{e.page++,u()},L=t=>{e.curTime=new Date(t).getTime(),e.page=1,u()},x=()=>{h.value.visiblePopover()};return q(()=>{const t=window.sessionStorage.getItem("statisticDetails");if(t){const o=JSON.parse(t);o.time&&(e.curTime=o.time),o.tabVal&&(r.value=o.tabVal)}}),(t,o)=>{const s=p("MonthSelect"),i=p("SvgIcon"),a=p("HkPopover"),N=p("SecondHeader"),O=p("DownRefresh"),V=p("MainContainer");return E(),Q(V,{exitLoading:!0,pageLoading:c(R)},{default:g(()=>[n(J,{curValue:c(r),tabConetnt:c(C),onOnChange:I},null,8,["curValue","tabConetnt"]),l("div",Y,[n(N,null,{default:g(()=>[l("div",Z,[l("div",ee,[n(s,{onOnTimeChange:L,value:e.curTime,dateType:c(r)},null,8,["value","dateType"])]),l("div",te,[n(a,{ref_key:"feePopoverRef",ref:h,trigger:"manual",options:c(P),value:c(d).type.value,pannelClass:"stic-minw-140",placement:"bottom-end",offset:[0,18],isSplitBorder:[0],isSelectState:!0,noDataTips:"暂无费用类型",onOnChange:o[0]||(o[0]=f=>k(f,"type"))},{taggleEle:g(()=>[l("div",{class:"hk-flex hk-items-center",onClick:x},[l("span",ae,F(c(d).type.text),1),n(i,{iconClass:"down-select-svg",size:"9",color:"#ffffff"})])]),_:1},8,["options","value"])])])]),_:1}),n(G,{total:e.total,type:"number",value:e.allPayMoney,currency:e.currency},null,8,["total","value","currency"]),l("div",oe,[n(O,{ref_key:"downRefreshRef",ref:y,dataList:_.value,pagination:e,onOnRefresh:S,onOnLoad:M},{default:g(({data:f})=>[n(K,{data:f,onClick:ne=>D(f)},null,8,["data","onClick"])]),_:1},8,["dataList","pagination"])])])]),_:1},8,["pageLoading"])}}});export{fe as default};
